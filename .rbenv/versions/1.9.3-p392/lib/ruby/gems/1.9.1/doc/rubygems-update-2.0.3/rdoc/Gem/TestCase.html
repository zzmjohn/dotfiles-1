<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Class: Gem::TestCase</title>

  <link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../lib/rubygems/test_case_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/rubygems/test_case.rb">lib/rubygems/test_case.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link">MiniTest::Unit::TestCase</p>
        
      </div>
      

      

      
      <!-- Namespace Contents -->
      <div id="namespace-list-section" class="section">
        <h3 class="section-header">Namespace</h3>
        <ul class="link-list">
          
          <li><span class="type">CLASS</span> <a href="TestCase/StaticSet.html">Gem::TestCase::StaticSet</a></li>
          
        </ul>
      </div>
      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-cert_path">::cert_path</a></li>
          
          <li><a href="#method-c-key_path">::key_path</a></li>
          
          <li><a href="#method-c-load_cert">::load_cert</a></li>
          
          <li><a href="#method-c-load_key">::load_key</a></li>
          
          <li><a href="#method-c-make_command">::make_command</a></li>
          
          <li><a href="#method-c-process_based_port">::process_based_port</a></li>
          
          <li><a href="#method-c-rubybin">::rubybin</a></li>
          
          <li><a href="#method-c-vc_windows-3F">::vc_windows?</a></li>
          
          <li><a href="#method-c-win_platform-3F">::win_platform?</a></li>
          
          <li><a href="#method-i-add_to_fetcher">#add_to_fetcher</a></li>
          
          <li><a href="#method-i-all_spec_names">#all_spec_names</a></li>
          
          <li><a href="#method-i-assert_path_exists">#assert_path_exists</a></li>
          
          <li><a href="#method-i-build_rake_in">#build_rake_in</a></li>
          
          <li><a href="#method-i-create_tmpdir">#create_tmpdir</a></li>
          
          <li><a href="#method-i-dep">#dep</a></li>
          
          <li><a href="#method-i-install_default_gems">#install_default_gems</a></li>
          
          <li><a href="#method-i-install_default_specs">#install_default_specs</a></li>
          
          <li><a href="#method-i-install_gem">#install_gem</a></li>
          
          <li><a href="#method-i-install_gem_user">#install_gem_user</a></li>
          
          <li><a href="#method-i-install_specs">#install_specs</a></li>
          
          <li><a href="#method-i-make_command">#make_command</a></li>
          
          <li><a href="#method-i-mu_pp">#mu_pp</a></li>
          
          <li><a href="#method-i-new_default_spec">#new_default_spec</a></li>
          
          <li><a href="#method-i-new_spec">#new_spec</a></li>
          
          <li><a href="#method-i-nmake_found-3F">#nmake_found?</a></li>
          
          <li><a href="#method-i-process_based_port">#process_based_port</a></li>
          
          <li><a href="#method-i-quick_gem">#quick_gem</a></li>
          
          <li><a href="#method-i-quick_spec">#quick_spec</a></li>
          
          <li><a href="#method-i-read_binary">#read_binary</a></li>
          
          <li><a href="#method-i-read_cache">#read_cache</a></li>
          
          <li><a href="#method-i-refute_path_exists">#refute_path_exists</a></li>
          
          <li><a href="#method-i-req">#req</a></li>
          
          <li><a href="#method-i-setup">#setup</a></li>
          
          <li><a href="#method-i-spec">#spec</a></li>
          
          <li><a href="#method-i-teardown">#teardown</a></li>
          
          <li><a href="#method-i-uninstall_gem">#uninstall_gem</a></li>
          
          <li><a href="#method-i-util_build_gem">#util_build_gem</a></li>
          
          <li><a href="#method-i-util_clear_gems">#util_clear_gems</a></li>
          
          <li><a href="#method-i-util_gem">#util_gem</a></li>
          
          <li><a href="#method-i-util_gzip">#util_gzip</a></li>
          
          <li><a href="#method-i-util_make_gems">#util_make_gems</a></li>
          
          <li><a href="#method-i-util_remove_gem">#util_remove_gem</a></li>
          
          <li><a href="#method-i-util_set_arch">#util_set_arch</a></li>
          
          <li><a href="#method-i-util_setup_fake_fetcher">#util_setup_fake_fetcher</a></li>
          
          <li><a href="#method-i-util_setup_spec_fetcher">#util_setup_spec_fetcher</a></li>
          
          <li><a href="#method-i-util_spec">#util_spec</a></li>
          
          <li><a href="#method-i-util_zip">#util_zip</a></li>
          
          <li><a href="#method-i-v">#v</a></li>
          
          <li><a href="#method-i-vc_windows-3F">#vc_windows?</a></li>
          
          <li><a href="#method-i-wait_for_child_process_to_exit">#wait_for_child_process_to_exit</a></li>
          
          <li><a href="#method-i-win_platform-3F">#win_platform?</a></li>
          
          <li><a href="#method-i-write_file">#write_file</a></li>
          
        </ul>
      </div>
      

      
      <!-- Included Modules -->
      <div id="includes-section" class="section">
        <h3 class="section-header">Included Modules</h3>
        <ul class="link-list">
        
        
          <li><a class="include" href="DefaultUserInteraction.html">Gem::DefaultUserInteraction</a></li>
        
        
        </ul>
      </div>
      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="../LICENSE_txt.html">LICENSE.txt</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../Gem.html">Gem</a></li>
        
          <li><a href="../Gem/AvailableSet.html">Gem::AvailableSet</a></li>
        
          <li><a href="../Gem/Command.html">Gem::Command</a></li>
        
          <li><a href="../Gem/CommandLineError.html">Gem::CommandLineError</a></li>
        
          <li><a href="../Gem/CommandManager.html">Gem::CommandManager</a></li>
        
          <li><a href="../Gem/Commands.html">Gem::Commands</a></li>
        
          <li><a href="../Gem/Commands/BuildCommand.html">Gem::Commands::BuildCommand</a></li>
        
          <li><a href="../Gem/Commands/CertCommand.html">Gem::Commands::CertCommand</a></li>
        
          <li><a href="../Gem/Commands/CheckCommand.html">Gem::Commands::CheckCommand</a></li>
        
          <li><a href="../Gem/Commands/CleanupCommand.html">Gem::Commands::CleanupCommand</a></li>
        
          <li><a href="../Gem/Commands/ContentsCommand.html">Gem::Commands::ContentsCommand</a></li>
        
          <li><a href="../Gem/Commands/DependencyCommand.html">Gem::Commands::DependencyCommand</a></li>
        
          <li><a href="../Gem/Commands/EnvironmentCommand.html">Gem::Commands::EnvironmentCommand</a></li>
        
          <li><a href="../Gem/Commands/FetchCommand.html">Gem::Commands::FetchCommand</a></li>
        
          <li><a href="../Gem/Commands/GenerateIndexCommand.html">Gem::Commands::GenerateIndexCommand</a></li>
        
          <li><a href="../Gem/Commands/HelpCommand.html">Gem::Commands::HelpCommand</a></li>
        
          <li><a href="../Gem/Commands/InstallCommand.html">Gem::Commands::InstallCommand</a></li>
        
          <li><a href="../Gem/Commands/ListCommand.html">Gem::Commands::ListCommand</a></li>
        
          <li><a href="../Gem/Commands/LockCommand.html">Gem::Commands::LockCommand</a></li>
        
          <li><a href="../Gem/Commands/MirrorCommand.html">Gem::Commands::MirrorCommand</a></li>
        
          <li><a href="../Gem/Commands/OutdatedCommand.html">Gem::Commands::OutdatedCommand</a></li>
        
          <li><a href="../Gem/Commands/OwnerCommand.html">Gem::Commands::OwnerCommand</a></li>
        
          <li><a href="../Gem/Commands/PristineCommand.html">Gem::Commands::PristineCommand</a></li>
        
          <li><a href="../Gem/Commands/PushCommand.html">Gem::Commands::PushCommand</a></li>
        
          <li><a href="../Gem/Commands/QueryCommand.html">Gem::Commands::QueryCommand</a></li>
        
          <li><a href="../Gem/Commands/RdocCommand.html">Gem::Commands::RdocCommand</a></li>
        
          <li><a href="../Gem/Commands/SearchCommand.html">Gem::Commands::SearchCommand</a></li>
        
          <li><a href="../Gem/Commands/ServerCommand.html">Gem::Commands::ServerCommand</a></li>
        
          <li><a href="../Gem/Commands/SetupCommand.html">Gem::Commands::SetupCommand</a></li>
        
          <li><a href="../Gem/Commands/SourcesCommand.html">Gem::Commands::SourcesCommand</a></li>
        
          <li><a href="../Gem/Commands/SpecificationCommand.html">Gem::Commands::SpecificationCommand</a></li>
        
          <li><a href="../Gem/Commands/StaleCommand.html">Gem::Commands::StaleCommand</a></li>
        
          <li><a href="../Gem/Commands/UninstallCommand.html">Gem::Commands::UninstallCommand</a></li>
        
          <li><a href="../Gem/Commands/UnpackCommand.html">Gem::Commands::UnpackCommand</a></li>
        
          <li><a href="../Gem/Commands/UpdateCommand.html">Gem::Commands::UpdateCommand</a></li>
        
          <li><a href="../Gem/Commands/WhichCommand.html">Gem::Commands::WhichCommand</a></li>
        
          <li><a href="../Gem/Commands/YankCommand.html">Gem::Commands::YankCommand</a></li>
        
          <li><a href="../Gem/ConfigFile.html">Gem::ConfigFile</a></li>
        
          <li><a href="../Gem/ConsoleUI.html">Gem::ConsoleUI</a></li>
        
          <li><a href="../Gem/DefaultUserInteraction.html">Gem::DefaultUserInteraction</a></li>
        
          <li><a href="../Gem/Dependency.html">Gem::Dependency</a></li>
        
          <li><a href="../Gem/DependencyError.html">Gem::DependencyError</a></li>
        
          <li><a href="../Gem/DependencyInstaller.html">Gem::DependencyInstaller</a></li>
        
          <li><a href="../Gem/DependencyList.html">Gem::DependencyList</a></li>
        
          <li><a href="../Gem/DependencyRemovalException.html">Gem::DependencyRemovalException</a></li>
        
          <li><a href="../Gem/DependencyResolutionError.html">Gem::DependencyResolutionError</a></li>
        
          <li><a href="../Gem/DependencyResolver.html">Gem::DependencyResolver</a></li>
        
          <li><a href="../Gem/DependencyResolver/APISet.html">Gem::DependencyResolver::APISet</a></li>
        
          <li><a href="../Gem/DependencyResolver/APISpecification.html">Gem::DependencyResolver::APISpecification</a></li>
        
          <li><a href="../Gem/DependencyResolver/ActivationRequest.html">Gem::DependencyResolver::ActivationRequest</a></li>
        
          <li><a href="../Gem/DependencyResolver/CurrentSet.html">Gem::DependencyResolver::CurrentSet</a></li>
        
          <li><a href="../Gem/DependencyResolver/DependencyConflict.html">Gem::DependencyResolver::DependencyConflict</a></li>
        
          <li><a href="../Gem/DependencyResolver/DependencyRequest.html">Gem::DependencyResolver::DependencyRequest</a></li>
        
          <li><a href="../Gem/DependencyResolver/IndexSet.html">Gem::DependencyResolver::IndexSet</a></li>
        
          <li><a href="../Gem/DependencyResolver/IndexSpecification.html">Gem::DependencyResolver::IndexSpecification</a></li>
        
          <li><a href="../Gem/Deprecate.html">Gem::Deprecate</a></li>
        
          <li><a href="../Gem/Doctor.html">Gem::Doctor</a></li>
        
          <li><a href="../Gem/DocumentError.html">Gem::DocumentError</a></li>
        
          <li><a href="../Gem/EndOfYAMLException.html">Gem::EndOfYAMLException</a></li>
        
          <li><a href="../Gem/ErrorReason.html">Gem::ErrorReason</a></li>
        
          <li><a href="../Gem/Exception.html">Gem::Exception</a></li>
        
          <li><a href="../Gem/Ext.html">Gem::Ext</a></li>
        
          <li><a href="../Gem/Ext/Builder.html">Gem::Ext::Builder</a></li>
        
          <li><a href="../Gem/Ext/CmakeBuilder.html">Gem::Ext::CmakeBuilder</a></li>
        
          <li><a href="../Gem/Ext/ConfigureBuilder.html">Gem::Ext::ConfigureBuilder</a></li>
        
          <li><a href="../Gem/Ext/ExtConfBuilder.html">Gem::Ext::ExtConfBuilder</a></li>
        
          <li><a href="../Gem/Ext/RakeBuilder.html">Gem::Ext::RakeBuilder</a></li>
        
          <li><a href="../Gem/FakeFetcher.html">Gem::FakeFetcher</a></li>
        
          <li><a href="../Gem/FilePermissionError.html">Gem::FilePermissionError</a></li>
        
          <li><a href="../Gem/FormatException.html">Gem::FormatException</a></li>
        
          <li><a href="../Gem/GemNotFoundException.html">Gem::GemNotFoundException</a></li>
        
          <li><a href="../Gem/GemNotInHomeException.html">Gem::GemNotInHomeException</a></li>
        
          <li><a href="../Gem/GemRunner.html">Gem::GemRunner</a></li>
        
          <li><a href="../Gem/GemcutterUtilities.html">Gem::GemcutterUtilities</a></li>
        
          <li><a href="../Gem/ImpossibleDependenciesError.html">Gem::ImpossibleDependenciesError</a></li>
        
          <li><a href="../Gem/Indexer.html">Gem::Indexer</a></li>
        
          <li><a href="../Gem/InstallError.html">Gem::InstallError</a></li>
        
          <li><a href="../Gem/InstallUpdateOptions.html">Gem::InstallUpdateOptions</a></li>
        
          <li><a href="../Gem/Installer.html">Gem::Installer</a></li>
        
          <li><a href="../Gem/Installer/ExtensionBuildError.html">Gem::Installer::ExtensionBuildError</a></li>
        
          <li><a href="../Gem/InstallerTestCase.html">Gem::InstallerTestCase</a></li>
        
          <li><a href="../Gem/InvalidSpecificationException.html">Gem::InvalidSpecificationException</a></li>
        
          <li><a href="../Gem/LoadError.html">Gem::LoadError</a></li>
        
          <li><a href="../Gem/LocalRemoteOptions.html">Gem::LocalRemoteOptions</a></li>
        
          <li><a href="../Gem/MockGemUi.html">Gem::MockGemUi</a></li>
        
          <li><a href="../Gem/MockGemUi/InputEOFError.html">Gem::MockGemUi::InputEOFError</a></li>
        
          <li><a href="../Gem/MockGemUi/SystemExitException.html">Gem::MockGemUi::SystemExitException</a></li>
        
          <li><a href="../Gem/MockGemUi/TTY.html">Gem::MockGemUi::TTY</a></li>
        
          <li><a href="../Gem/MockGemUi/TermError.html">Gem::MockGemUi::TermError</a></li>
        
          <li><a href="../Gem/NameTuple.html">Gem::NameTuple</a></li>
        
          <li><a href="../Gem/NoAliasYAMLTree.html">Gem::NoAliasYAMLTree</a></li>
        
          <li><a href="../Gem/OperationNotSupportedError.html">Gem::OperationNotSupportedError</a></li>
        
          <li><a href="../Gem/Package.html">Gem::Package</a></li>
        
          <li><a href="../Gem/Package/DigestIO.html">Gem::Package::DigestIO</a></li>
        
          <li><a href="../Gem/Package/Error.html">Gem::Package::Error</a></li>
        
          <li><a href="../Gem/Package/FormatError.html">Gem::Package::FormatError</a></li>
        
          <li><a href="../Gem/Package/NonSeekableIO.html">Gem::Package::NonSeekableIO</a></li>
        
          <li><a href="../Gem/Package/Old.html">Gem::Package::Old</a></li>
        
          <li><a href="../Gem/Package/PathError.html">Gem::Package::PathError</a></li>
        
          <li><a href="../Gem/Package/TarHeader.html">Gem::Package::TarHeader</a></li>
        
          <li><a href="../Gem/Package/TarInvalidError.html">Gem::Package::TarInvalidError</a></li>
        
          <li><a href="../Gem/Package/TarReader.html">Gem::Package::TarReader</a></li>
        
          <li><a href="../Gem/Package/TarReader/Entry.html">Gem::Package::TarReader::Entry</a></li>
        
          <li><a href="../Gem/Package/TarReader/UnexpectedEOF.html">Gem::Package::TarReader::UnexpectedEOF</a></li>
        
          <li><a href="../Gem/Package/TarTestCase.html">Gem::Package::TarTestCase</a></li>
        
          <li><a href="../Gem/Package/TarWriter.html">Gem::Package::TarWriter</a></li>
        
          <li><a href="../Gem/Package/TarWriter/BoundedStream.html">Gem::Package::TarWriter::BoundedStream</a></li>
        
          <li><a href="../Gem/Package/TarWriter/FileOverflow.html">Gem::Package::TarWriter::FileOverflow</a></li>
        
          <li><a href="../Gem/Package/TarWriter/RestrictedStream.html">Gem::Package::TarWriter::RestrictedStream</a></li>
        
          <li><a href="../Gem/Package/TooLongFileName.html">Gem::Package::TooLongFileName</a></li>
        
          <li><a href="../Gem/PackageTask.html">Gem::PackageTask</a></li>
        
          <li><a href="../Gem/PathSupport.html">Gem::PathSupport</a></li>
        
          <li><a href="../Gem/Platform.html">Gem::Platform</a></li>
        
          <li><a href="../Gem/PlatformMismatch.html">Gem::PlatformMismatch</a></li>
        
          <li><a href="../Gem/RDoc.html">Gem::RDoc</a></li>
        
          <li><a href="../Gem/RemoteError.html">Gem::RemoteError</a></li>
        
          <li><a href="../Gem/RemoteFetcher.html">Gem::RemoteFetcher</a></li>
        
          <li><a href="../Gem/RemoteFetcher/FetchError.html">Gem::RemoteFetcher::FetchError</a></li>
        
          <li><a href="../Gem/RemoteFetcher/UnknownHostError.html">Gem::RemoteFetcher::UnknownHostError</a></li>
        
          <li><a href="../Gem/RemoteInstallationCancelled.html">Gem::RemoteInstallationCancelled</a></li>
        
          <li><a href="../Gem/RemoteInstallationSkipped.html">Gem::RemoteInstallationSkipped</a></li>
        
          <li><a href="../Gem/RemoteSourceException.html">Gem::RemoteSourceException</a></li>
        
          <li><a href="../Gem/RequestSet.html">Gem::RequestSet</a></li>
        
          <li><a href="../Gem/RequestSet/GemDepedencyAPI.html">Gem::RequestSet::GemDepedencyAPI</a></li>
        
          <li><a href="../Gem/Requirement.html">Gem::Requirement</a></li>
        
          <li><a href="../Gem/Requirement.html">Gem::Requirement</a></li>
        
          <li><a href="../Gem/Requirement/BadRequirementError.html">Gem::Requirement::BadRequirementError</a></li>
        
          <li><a href="../Gem/Security.html">Gem::Security</a></li>
        
          <li><a href="../Gem/Security/Exception.html">Gem::Security::Exception</a></li>
        
          <li><a href="../Gem/Security/Policy.html">Gem::Security::Policy</a></li>
        
          <li><a href="../Gem/Security/Signer.html">Gem::Security::Signer</a></li>
        
          <li><a href="../Gem/Security/TrustDir.html">Gem::Security::TrustDir</a></li>
        
          <li><a href="../Gem/Server.html">Gem::Server</a></li>
        
          <li><a href="../Gem/SilentUI.html">Gem::SilentUI</a></li>
        
          <li><a href="../Gem/Source.html">Gem::Source</a></li>
        
          <li><a href="../Gem/Source/Local.html">Gem::Source::Local</a></li>
        
          <li><a href="../Gem/Source/SpecificFile.html">Gem::Source::SpecificFile</a></li>
        
          <li><a href="../Gem/SourceFetchProblem.html">Gem::SourceFetchProblem</a></li>
        
          <li><a href="../Gem/SourceList.html">Gem::SourceList</a></li>
        
          <li><a href="../Gem/SpecFetcher.html">Gem::SpecFetcher</a></li>
        
          <li><a href="../Gem/SpecificGemNotFoundException.html">Gem::SpecificGemNotFoundException</a></li>
        
          <li><a href="../Gem/Specification.html">Gem::Specification</a></li>
        
          <li><a href="../Gem/StreamUI.html">Gem::StreamUI</a></li>
        
          <li><a href="../Gem/StreamUI/SilentDownloadReporter.html">Gem::StreamUI::SilentDownloadReporter</a></li>
        
          <li><a href="../Gem/StreamUI/SilentProgressReporter.html">Gem::StreamUI::SilentProgressReporter</a></li>
        
          <li><a href="../Gem/StreamUI/SimpleProgressReporter.html">Gem::StreamUI::SimpleProgressReporter</a></li>
        
          <li><a href="../Gem/StreamUI/VerboseDownloadReporter.html">Gem::StreamUI::VerboseDownloadReporter</a></li>
        
          <li><a href="../Gem/StreamUI/VerboseProgressReporter.html">Gem::StreamUI::VerboseProgressReporter</a></li>
        
          <li><a href="../Gem/SystemExitException.html">Gem::SystemExitException</a></li>
        
          <li><a href="../Gem/TestCase.html">Gem::TestCase</a></li>
        
          <li><a href="../Gem/TestCase/StaticSet.html">Gem::TestCase::StaticSet</a></li>
        
          <li><a href="../Gem/Text.html">Gem::Text</a></li>
        
          <li><a href="../Gem/Uninstaller.html">Gem::Uninstaller</a></li>
        
          <li><a href="../Gem/UnsatisfiableDepedencyError.html">Gem::UnsatisfiableDepedencyError</a></li>
        
          <li><a href="../Gem/UserInteraction.html">Gem::UserInteraction</a></li>
        
          <li><a href="../Gem/Validator.html">Gem::Validator</a></li>
        
          <li><a href="../Gem/VerificationError.html">Gem::VerificationError</a></li>
        
          <li><a href="../Gem/Version.html">Gem::Version</a></li>
        
          <li><a href="../Gem/VersionOption.html">Gem::VersionOption</a></li>
        
          <li><a href="../OpenSSL.html">OpenSSL</a></li>
        
          <li><a href="../OpenSSL/Digest.html">OpenSSL::Digest</a></li>
        
          <li><a href="../OpenSSL/Digest/SHA1.html">OpenSSL::Digest::SHA1</a></li>
        
          <li><a href="../OpenSSL/Digest/SHA1.html">OpenSSL::Digest::SHA1</a></li>
        
          <li><a href="../OpenSSL/PKey.html">OpenSSL::PKey</a></li>
        
          <li><a href="../OpenSSL/PKey/RSA.html">OpenSSL::PKey::RSA</a></li>
        
          <li><a href="../OpenSSL/PKey/RSA.html">OpenSSL::PKey::RSA</a></li>
        
          <li><a href="../Psych.html">Psych</a></li>
        
          <li><a href="../Psych/PrivateType.html">Psych::PrivateType</a></li>
        
          <li><a href="../GemGauntlet.html">GemGauntlet</a></li>
        
          <li><a href="../Kernel.html">Kernel</a></li>
        
          <li><a href="../Object.html">Object</a></li>
        
          <li><a href="../TempIO.html">TempIO</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">Gem::TestCase</h1>

    <div id="description" class="description">
      
<p>RubyGemTestCase provides a variety of methods for testing rubygems and
gem-related behavior in a sandbox.  Through RubyGemTestCase you can install
and uninstall gems, fetch remote gems through a stub fetcher and be assured
your normal set of gems is not affected.</p>

<p>Tests are always run at a safe level of 1.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="cert_path-method" class="method-detail ">
          <a name="method-c-cert_path"></a>

          
          <div class="method-heading">
            <span class="method-name">cert_path</span><span
              class="method-args">(cert_name)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the path to the certificate named <tt>cert_name</tt> from
<tt>test/rubygems/</tt>.</p>
            

            
            <div class="method-source-code" id="cert_path-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 1006</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">cert_path</span> <span class="ruby-identifier">cert_name</span>
  <span class="ruby-keyword">if</span> <span class="ruby-value">32</span> <span class="ruby-operator">==</span> (<span class="ruby-constant">Time</span>.<span class="ruby-identifier">at</span>(<span class="ruby-value">2</span><span class="ruby-operator">**</span><span class="ruby-value">32</span>) <span class="ruby-keyword">rescue</span> <span class="ruby-value">32</span>) <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">cert_file</span> =
      <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span> <span class="ruby-node">&quot;../../../test/rubygems/#{cert_name}_cert_32.pem&quot;</span>,
                       <span class="ruby-keyword">__FILE__</span>

    <span class="ruby-keyword">return</span> <span class="ruby-identifier">cert_file</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">cert_file</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span> <span class="ruby-node">&quot;../../../test/rubygems/#{cert_name}_cert.pem&quot;</span>, <span class="ruby-keyword">__FILE__</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- cert_path-source -->
            
          </div>

          

          
        </div><!-- cert_path-method -->

      
        <div id="key_path-method" class="method-detail ">
          <a name="method-c-key_path"></a>

          
          <div class="method-heading">
            <span class="method-name">key_path</span><span
              class="method-args">(key_name)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the path tot he key named <tt>key_name</tt> from
<tt>test/rubygems</tt></p>
            

            
            <div class="method-source-code" id="key_path-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 1032</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">key_path</span> <span class="ruby-identifier">key_name</span>
  <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span> <span class="ruby-node">&quot;../../../test/rubygems/#{key_name}_key.pem&quot;</span>, <span class="ruby-keyword">__FILE__</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- key_path-source -->
            
          </div>

          

          
        </div><!-- key_path-method -->

      
        <div id="load_cert-method" class="method-detail ">
          <a name="method-c-load_cert"></a>

          
          <div class="method-heading">
            <span class="method-name">load_cert</span><span
              class="method-args">(cert_name)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Loads certificate named <tt>cert_name</tt> from <tt>test/rubygems/</tt>.</p>
            

            
            <div class="method-source-code" id="load_cert-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 994</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">load_cert</span> <span class="ruby-identifier">cert_name</span>
  <span class="ruby-identifier">cert_file</span> = <span class="ruby-identifier">cert_path</span> <span class="ruby-identifier">cert_name</span>

  <span class="ruby-identifier">cert</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span> <span class="ruby-identifier">cert_file</span>

  <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">X509</span><span class="ruby-operator">::</span><span class="ruby-constant">Certificate</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">cert</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- load_cert-source -->
            
          </div>

          

          
        </div><!-- load_cert-method -->

      
        <div id="load_key-method" class="method-detail ">
          <a name="method-c-load_key"></a>

          
          <div class="method-heading">
            <span class="method-name">load_key</span><span
              class="method-args">(key_name)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Loads an RSA private key named <tt>key_name</tt> in <tt>test/rubygems/</tt></p>
            

            
            <div class="method-source-code" id="load_key-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 1021</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">load_key</span> <span class="ruby-identifier">key_name</span>
  <span class="ruby-identifier">key_file</span> = <span class="ruby-identifier">key_path</span> <span class="ruby-identifier">key_name</span>

  <span class="ruby-identifier">key</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span> <span class="ruby-identifier">key_file</span>

  <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">PKey</span><span class="ruby-operator">::</span><span class="ruby-constant">RSA</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">key</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- load_key-source -->
            
          </div>

          

          
        </div><!-- load_key-method -->

      
        <div id="make_command-method" class="method-detail ">
          <a name="method-c-make_command"></a>

          
          <div class="method-heading">
            <span class="method-name">make_command</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the make command for the current platform. For versions of Ruby
built on MS Windows with VC++ or Borland it will return ‘nmake’. On all
other platforms, including Cygwin, it will return ‘make’.</p>
            

            
            <div class="method-source-code" id="make_command-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 847</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">make_command</span>
  <span class="ruby-constant">ENV</span>[<span class="ruby-string">&quot;make&quot;</span>] <span class="ruby-operator">||</span> (<span class="ruby-identifier">vc_windows?</span> <span class="ruby-operator">?</span> <span class="ruby-string">'nmake'</span> <span class="ruby-operator">:</span> <span class="ruby-string">'make'</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- make_command-source -->
            
          </div>

          

          
        </div><!-- make_command-method -->

      
        <div id="process_based_port-method" class="method-detail ">
          <a name="method-c-process_based_port"></a>

          
          <div class="method-heading">
            <span class="method-name">process_based_port</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Allows tests to use a random (but controlled) port number instead of a
hardcoded one. This helps CI tools when running parallels builds on the
same builder slave.</p>
            

            
            <div class="method-source-code" id="process_based_port-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 880</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">process_based_port</span>
  <span class="ruby-identifier">@@process_based_port</span> <span class="ruby-operator">||=</span> <span class="ruby-value">8000</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$$</span> <span class="ruby-operator">%</span> <span class="ruby-value">1000</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- process_based_port-source -->
            
          </div>

          

          
        </div><!-- process_based_port-method -->

      
        <div id="rubybin-method" class="method-detail ">
          <a name="method-c-rubybin"></a>

          
          <div class="method-heading">
            <span class="method-name">rubybin</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Finds the path to the ruby executable</p>
            

            
            <div class="method-source-code" id="rubybin-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 913</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">rubybin</span>
  <span class="ruby-identifier">ruby</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-string">&quot;RUBY&quot;</span>]
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">ruby</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">ruby</span>
  <span class="ruby-identifier">ruby</span> = <span class="ruby-string">&quot;ruby&quot;</span>
  <span class="ruby-identifier">rubyexe</span> = <span class="ruby-node">&quot;#{ruby}.exe&quot;</span>

  <span class="ruby-value">3</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">ruby</span> <span class="ruby-keyword">and</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span> <span class="ruby-identifier">ruby</span> <span class="ruby-keyword">and</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span> <span class="ruby-identifier">ruby</span>
      <span class="ruby-keyword">return</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">ruby</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">rubyexe</span> <span class="ruby-keyword">and</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span> <span class="ruby-identifier">rubyexe</span>
      <span class="ruby-keyword">return</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">rubyexe</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">ruby</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;..&quot;</span>, <span class="ruby-identifier">ruby</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">require</span> <span class="ruby-string">&quot;rbconfig&quot;</span>
    <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">RbConfig</span><span class="ruby-operator">::</span><span class="ruby-constant">CONFIG</span>[<span class="ruby-string">&quot;bindir&quot;</span>],
              <span class="ruby-constant">RbConfig</span><span class="ruby-operator">::</span><span class="ruby-constant">CONFIG</span>[<span class="ruby-string">&quot;ruby_install_name&quot;</span>] <span class="ruby-operator">+</span>
              <span class="ruby-constant">RbConfig</span><span class="ruby-operator">::</span><span class="ruby-constant">CONFIG</span>[<span class="ruby-string">&quot;EXEEXT&quot;</span>])
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">LoadError</span>
    <span class="ruby-string">&quot;ruby&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- rubybin-source -->
            
          </div>

          

          
        </div><!-- rubybin-method -->

      
        <div id="vc_windows-3F-method" class="method-detail ">
          <a name="method-c-vc_windows-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">vc_windows?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns whether or not we’re on a version of Ruby built with VC++ (or
Borland) versus Cygwin, Mingw, etc.</p>
            

            
            <div class="method-source-code" id="vc_windows-3F-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 830</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">vc_windows?</span>
  <span class="ruby-constant">RUBY_PLATFORM</span>.<span class="ruby-identifier">match</span>(<span class="ruby-string">'mswin'</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- vc_windows-3F-source -->
            
          </div>

          

          
        </div><!-- vc_windows-3F-method -->

      
        <div id="win_platform-3F-method" class="method-detail ">
          <a name="method-c-win_platform-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">win_platform?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Is this test being run on a Windows platform?</p>
            

            
            <div class="method-source-code" id="win_platform-3F-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 815</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">win_platform?</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">win_platform?</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- win_platform-3F-source -->
            
          </div>

          

          
        </div><!-- win_platform-3F-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="add_to_fetcher-method" class="method-detail ">
          <a name="method-i-add_to_fetcher"></a>

          
          <div class="method-heading">
            <span class="method-name">add_to_fetcher</span><span
              class="method-args">(spec, path=nil, repo=@gem_repo)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Add <tt>spec</tt> to +@fetcher+ serving the data in the file <tt>path</tt>.
<tt>repo</tt> indicates which repo to make <tt>spec</tt> appear to be in.</p>
            

            
            <div class="method-source-code" id="add_to_fetcher-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 759</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_to_fetcher</span>(<span class="ruby-identifier">spec</span>, <span class="ruby-identifier">path</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">repo</span>=<span class="ruby-ivar">@gem_repo</span>)
  <span class="ruby-identifier">path</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">cache_file</span>
  <span class="ruby-ivar">@fetcher</span>.<span class="ruby-identifier">data</span>[<span class="ruby-node">&quot;#{@gem_repo}gems/#{spec.file_name}&quot;</span>] = <span class="ruby-identifier">read_binary</span>(<span class="ruby-identifier">path</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- add_to_fetcher-source -->
            
          </div>

          

          
        </div><!-- add_to_fetcher-method -->

      
        <div id="all_spec_names-method" class="method-detail ">
          <a name="method-i-all_spec_names"></a>

          
          <div class="method-heading">
            <span class="method-name">all_spec_names</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="all_spec_names-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 369</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">all_spec_names</span>
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">map</span>(&amp;<span class="ruby-value">:full_name</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- all_spec_names-source -->
            
          </div>

          

          
        </div><!-- all_spec_names-method -->

      
        <div id="assert_path_exists-method" class="method-detail ">
          <a name="method-i-assert_path_exists"></a>

          
          <div class="method-heading">
            <span class="method-name">assert_path_exists</span><span
              class="method-args">(path, msg = nil)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>TODO: move to minitest</p>
            

            
            <div class="method-source-code" id="assert_path_exists-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 81</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">assert_path_exists</span> <span class="ruby-identifier">path</span>, <span class="ruby-identifier">msg</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">msg</span> = <span class="ruby-identifier">message</span>(<span class="ruby-identifier">msg</span>) { <span class="ruby-node">&quot;Expected path '#{path}' to exist&quot;</span> }
  <span class="ruby-identifier">assert</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-identifier">path</span>), <span class="ruby-identifier">msg</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- assert_path_exists-source -->
            
          </div>

          

          
        </div><!-- assert_path_exists-method -->

      
        <div id="build_rake_in-method" class="method-detail ">
          <a name="method-i-build_rake_in"></a>

          
          <div class="method-heading">
            <span class="method-name">build_rake_in</span><span
              class="method-args">(good=true)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Allows the proper version of <tt>rake</tt> to be used for the test.</p>
            

            
            <div class="method-source-code" id="build_rake_in-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 894</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">build_rake_in</span>(<span class="ruby-identifier">good</span>=<span class="ruby-keyword">true</span>)
  <span class="ruby-identifier">gem_ruby</span> = <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">ruby</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">ruby</span> = <span class="ruby-identifier">@@ruby</span>
  <span class="ruby-identifier">env_rake</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-string">&quot;rake&quot;</span>]
  <span class="ruby-identifier">rake</span> = (<span class="ruby-identifier">good</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">@@good_rake</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">@@bad_rake</span>)
  <span class="ruby-constant">ENV</span>[<span class="ruby-string">&quot;rake&quot;</span>] = <span class="ruby-identifier">rake</span>
  <span class="ruby-keyword">yield</span> <span class="ruby-identifier">rake</span>
<span class="ruby-keyword">ensure</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">ruby</span> = <span class="ruby-identifier">gem_ruby</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">env_rake</span>
    <span class="ruby-constant">ENV</span>[<span class="ruby-string">&quot;rake&quot;</span>] = <span class="ruby-identifier">env_rake</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-constant">ENV</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-string">&quot;rake&quot;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- build_rake_in-source -->
            
          </div>

          

          
        </div><!-- build_rake_in-method -->

      
        <div id="create_tmpdir-method" class="method-detail ">
          <a name="method-i-create_tmpdir"></a>

          
          <div class="method-heading">
            <span class="method-name">create_tmpdir</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>creates a temporary directory with hax TODO: deprecate and remove</p>
            

            
            <div class="method-source-code" id="create_tmpdir-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 320</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_tmpdir</span>
  <span class="ruby-identifier">tmpdir</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span> <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">tmpdir</span> <span class="ruby-keyword">do</span> <span class="ruby-identifier">tmpdir</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">pwd</span> <span class="ruby-keyword">end</span> <span class="ruby-comment"># HACK OSX /private/tmp</span>
  <span class="ruby-identifier">tmpdir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">tmpdir</span>, <span class="ruby-node">&quot;test_rubygems_#{$$}&quot;</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-identifier">tmpdir</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">tmpdir</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- create_tmpdir-source -->
            
          </div>

          

          
        </div><!-- create_tmpdir-method -->

      
        <div id="dep-method" class="method-detail ">
          <a name="method-i-dep"></a>

          
          <div class="method-heading">
            <span class="method-name">dep</span><span
              class="method-args">(name, *requirements)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Construct a new <a href="Dependency.html">Gem::Dependency</a>.</p>
            

            
            <div class="method-source-code" id="dep-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 946</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dep</span> <span class="ruby-identifier">name</span>, *<span class="ruby-identifier">requirements</span>
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Dependency</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">name</span>, *<span class="ruby-identifier">requirements</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- dep-source -->
            
          </div>

          

          
        </div><!-- dep-method -->

      
        <div id="install_default_gems-method" class="method-detail ">
          <a name="method-i-install_default_gems"></a>

          
          <div class="method-heading">
            <span class="method-name">install_default_gems</span><span
              class="method-args">(*specs)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Installs the provided default specs including writing the spec file</p>
            

            
            <div class="method-source-code" id="install_default_gems-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 485</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">install_default_gems</span>(*<span class="ruby-identifier">specs</span>)
  <span class="ruby-identifier">install_default_specs</span>(*<span class="ruby-identifier">specs</span>)

  <span class="ruby-identifier">specs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spec</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">open</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">loaded_from</span>, <span class="ruby-string">'w'</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">io</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">to_ruby_for_cache</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- install_default_gems-source -->
            
          </div>

          

          
        </div><!-- install_default_gems-method -->

      
        <div id="install_default_specs-method" class="method-detail ">
          <a name="method-i-install_default_specs"></a>

          
          <div class="method-heading">
            <span class="method-name">install_default_specs</span><span
              class="method-args">(*specs)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Install the provided default specs</p>
            

            
            <div class="method-source-code" id="install_default_specs-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 498</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">install_default_specs</span>(*<span class="ruby-identifier">specs</span>)
  <span class="ruby-identifier">install_specs</span>(*<span class="ruby-identifier">specs</span>)
  <span class="ruby-identifier">specs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spec</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">register_default_spec</span>(<span class="ruby-identifier">spec</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- install_default_specs-source -->
            
          </div>

          

          
        </div><!-- install_default_specs-method -->

      
        <div id="install_gem-method" class="method-detail ">
          <a name="method-i-install_gem"></a>

          
          <div class="method-heading">
            <span class="method-name">install_gem</span><span
              class="method-args">(spec, options = {})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Builds and installs the <a href="Specification.html">Gem::Specification</a>
<tt>spec</tt></p>
            

            
            <div class="method-source-code" id="install_gem-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 282</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">install_gem</span> <span class="ruby-identifier">spec</span>, <span class="ruby-identifier">options</span> = {}
  <span class="ruby-identifier">require</span> <span class="ruby-string">'rubygems/installer'</span>

  <span class="ruby-identifier">gem</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-ivar">@tempdir</span>, <span class="ruby-string">&quot;gems&quot;</span>, <span class="ruby-node">&quot;#{spec.full_name}.gem&quot;</span>

  <span class="ruby-keyword">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span> <span class="ruby-identifier">gem</span>
    <span class="ruby-identifier">use_ui</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">MockGemUi</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span>
      <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span> <span class="ruby-ivar">@tempdir</span> <span class="ruby-keyword">do</span>
        <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Package</span>.<span class="ruby-identifier">build</span> <span class="ruby-identifier">spec</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">gem</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@tempdir</span>, <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">spec</span>.<span class="ruby-identifier">cache_file</span>)).<span class="ruby-identifier">untaint</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Installer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">gem</span>, <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge</span>({<span class="ruby-value">:wrappers</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>})).<span class="ruby-identifier">install</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- install_gem-source -->
            
          </div>

          

          
        </div><!-- install_gem-method -->

      
        <div id="install_gem_user-method" class="method-detail ">
          <a name="method-i-install_gem_user"></a>

          
          <div class="method-heading">
            <span class="method-name">install_gem_user</span><span
              class="method-args">(spec)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Builds and installs the <a href="Specification.html">Gem::Specification</a>
<tt>spec</tt> into the user dir</p>
            

            
            <div class="method-source-code" id="install_gem_user-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 303</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">install_gem_user</span> <span class="ruby-identifier">spec</span>
  <span class="ruby-identifier">install_gem</span> <span class="ruby-identifier">spec</span>, <span class="ruby-value">:user_install</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- install_gem_user-source -->
            
          </div>

          

          
        </div><!-- install_gem_user-method -->

      
        <div id="install_specs-method" class="method-detail ">
          <a name="method-i-install_specs"></a>

          
          <div class="method-heading">
            <span class="method-name">install_specs</span><span
              class="method-args">(*specs)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Install the provided specs</p>
            

            
            <div class="method-source-code" id="install_specs-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 477</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">install_specs</span>(*<span class="ruby-identifier">specs</span>)
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">add_specs</span>(*<span class="ruby-identifier">specs</span>)
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">searcher</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- install_specs-source -->
            
          </div>

          

          
        </div><!-- install_specs-method -->

      
        <div id="make_command-method" class="method-detail ">
          <a name="method-i-make_command"></a>

          
          <div class="method-heading">
            <span class="method-name">make_command</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the make command for the current platform. For versions of Ruby
built on MS Windows with VC++ or Borland it will return ‘nmake’. On all
other platforms, including Cygwin, it will return ‘make’.</p>
            

            
            <div class="method-source-code" id="make_command-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 856</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">make_command</span>
  <span class="ruby-constant">ENV</span>[<span class="ruby-string">&quot;make&quot;</span>] <span class="ruby-operator">||</span> (<span class="ruby-identifier">vc_windows?</span> <span class="ruby-operator">?</span> <span class="ruby-string">'nmake'</span> <span class="ruby-operator">:</span> <span class="ruby-string">'make'</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- make_command-source -->
            
          </div>

          

          
        </div><!-- make_command-method -->

      
        <div id="mu_pp-method" class="method-detail ">
          <a name="method-i-mu_pp"></a>

          
          <div class="method-heading">
            <span class="method-name">mu_pp</span><span
              class="method-args">(obj)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Enables pretty-print for all tests</p>
            

            
            <div class="method-source-code" id="mu_pp-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 331</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">mu_pp</span>(<span class="ruby-identifier">obj</span>)
  <span class="ruby-identifier">s</span> = <span class="ruby-string">''</span>
  <span class="ruby-identifier">s</span> = <span class="ruby-constant">PP</span>.<span class="ruby-identifier">pp</span> <span class="ruby-identifier">obj</span>, <span class="ruby-identifier">s</span>
  <span class="ruby-identifier">s</span> = <span class="ruby-identifier">s</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">default_external</span>) <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span> <span class="ruby-constant">Encoding</span>
  <span class="ruby-identifier">s</span>.<span class="ruby-identifier">chomp</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- mu_pp-source -->
            
          </div>

          

          
        </div><!-- mu_pp-method -->

      
        <div id="new_default_spec-method" class="method-detail ">
          <a name="method-i-new_default_spec"></a>

          
          <div class="method-heading">
            <span class="method-name">new_default_spec</span><span
              class="method-args">(name, version, deps = nil, *files)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="new_default_spec-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 549</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">new_default_spec</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">version</span>, <span class="ruby-identifier">deps</span> = <span class="ruby-keyword">nil</span>, *<span class="ruby-identifier">files</span>)
  <span class="ruby-identifier">spec</span> = <span class="ruby-identifier">new_spec</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">version</span>, <span class="ruby-identifier">deps</span>)
  <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">loaded_from</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@default_spec_dir</span>, <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">spec_name</span>)
  <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">files</span> = <span class="ruby-identifier">files</span>

  <span class="ruby-identifier">lib_dir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@tempdir</span>, <span class="ruby-string">&quot;default_gems&quot;</span>, <span class="ruby-string">&quot;lib&quot;</span>)
  <span class="ruby-identifier">$LOAD_PATH</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-identifier">lib_dir</span>)
  <span class="ruby-identifier">files</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">rb_path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">lib_dir</span>, <span class="ruby-identifier">file</span>)
    <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">rb_path</span>))
    <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">rb_path</span>, <span class="ruby-string">&quot;w&quot;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rb</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">rb</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;# #{file}&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">spec</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new_default_spec-source -->
            
          </div>

          

          
        </div><!-- new_default_spec-method -->

      
        <div id="new_spec-method" class="method-detail ">
          <a name="method-i-new_spec"></a>

          
          <div class="method-heading">
            <span class="method-name">new_spec</span><span
              class="method-args">(name, version, deps = nil, *files)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Create a new spec (or gem if passed an array of files) and set it up
properly. Use this instead of <a
href="TestCase.html#method-i-util_spec">util_spec</a> and util_gem.</p>
            

            
            <div class="method-source-code" id="new_spec-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 509</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">new_spec</span> <span class="ruby-identifier">name</span>, <span class="ruby-identifier">version</span>, <span class="ruby-identifier">deps</span> = <span class="ruby-keyword">nil</span>, *<span class="ruby-identifier">files</span>
  <span class="ruby-identifier">require</span> <span class="ruby-string">'rubygems/specification'</span>

  <span class="ruby-identifier">spec</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">platform</span>    = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Platform</span><span class="ruby-operator">::</span><span class="ruby-constant">RUBY</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">name</span>        = <span class="ruby-identifier">name</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">version</span>     = <span class="ruby-identifier">version</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">author</span>      = <span class="ruby-string">'A User'</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">email</span>       = <span class="ruby-string">'example@example.com'</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">homepage</span>    = <span class="ruby-string">'http://example.com'</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">summary</span>     = <span class="ruby-string">&quot;this is a summary&quot;</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">description</span> = <span class="ruby-string">&quot;This is a test description&quot;</span>

    <span class="ruby-constant">Array</span>(<span class="ruby-identifier">deps</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span>, <span class="ruby-identifier">req</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">s</span>.<span class="ruby-identifier">add_dependency</span> <span class="ruby-identifier">n</span>, (<span class="ruby-identifier">req</span> <span class="ruby-operator">||</span> <span class="ruby-string">'&gt;= 0'</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">files</span>.<span class="ruby-identifier">push</span>(*<span class="ruby-identifier">files</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">files</span>.<span class="ruby-identifier">empty?</span>

    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">s</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">loaded_from</span> = <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">spec_file</span>

  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">files</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">write_file</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">spec_file</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">io</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">to_ruby_for_cache</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">util_build_gem</span> <span class="ruby-identifier">spec</span>

    <span class="ruby-identifier">cache_file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-ivar">@tempdir</span>, <span class="ruby-string">'gems'</span>, <span class="ruby-node">&quot;#{spec.full_name}.gem&quot;</span>
    <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span> <span class="ruby-identifier">cache_file</span>
    <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mv</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">cache_file</span>, <span class="ruby-identifier">cache_file</span>
    <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">spec_file</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">spec</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new_spec-source -->
            
          </div>

          

          
        </div><!-- new_spec-method -->

      
        <div id="nmake_found-3F-method" class="method-detail ">
          <a name="method-i-nmake_found-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">nmake_found?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns whether or not the nmake command could be found.</p>
            

            
            <div class="method-source-code" id="nmake_found-3F-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 863</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">nmake_found?</span>
  <span class="ruby-identifier">system</span>(<span class="ruby-string">'nmake /? 1&gt;NUL 2&gt;&amp;1'</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- nmake_found-3F-source -->
            
          </div>

          

          
        </div><!-- nmake_found-3F-method -->

      
        <div id="process_based_port-method" class="method-detail ">
          <a name="method-i-process_based_port"></a>

          
          <div class="method-heading">
            <span class="method-name">process_based_port</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>See <a
href="TestCase.html#method-c-process_based_port">::process_based_port</a></p>
            

            
            <div class="method-source-code" id="process_based_port-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 887</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">process_based_port</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">process_based_port</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- process_based_port-source -->
            
          </div>

          

          
        </div><!-- process_based_port-method -->

      
        <div id="quick_gem-method" class="method-detail ">
          <a name="method-i-quick_gem"></a>

          
          <div class="method-heading">
            <span class="method-name">quick_gem</span><span
              class="method-args">(name, version='2')</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Creates a <a href="Specification.html">Gem::Specification</a> with a
minimum of extra work.  <tt>name</tt> and <tt>version</tt> are the gem’s
name and version,  platform, author, email, homepage, summary and
description are defaulted.  The specification is yielded for customization.</p>

<p>The gem is added to the installed gems in +@gemhome+ and the runtime.</p>

<p>Use this with <a href="TestCase.html#method-i-write_file">write_file</a> to
build an installed gem.</p>
            

            
            <div class="method-source-code" id="quick_gem-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 383</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">quick_gem</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">version</span>=<span class="ruby-string">'2'</span>)
  <span class="ruby-identifier">require</span> <span class="ruby-string">'rubygems/specification'</span>

  <span class="ruby-identifier">spec</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">platform</span>    = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Platform</span><span class="ruby-operator">::</span><span class="ruby-constant">RUBY</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">name</span>        = <span class="ruby-identifier">name</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">version</span>     = <span class="ruby-identifier">version</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">author</span>      = <span class="ruby-string">'A User'</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">email</span>       = <span class="ruby-string">'example@example.com'</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">homepage</span>    = <span class="ruby-string">'http://example.com'</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">summary</span>     = <span class="ruby-string">&quot;this is a summary&quot;</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">description</span> = <span class="ruby-string">&quot;This is a test description&quot;</span>

    <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">s</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">map</span> <span class="ruby-comment"># HACK: force specs to (re-)load before we write</span>

  <span class="ruby-identifier">written_path</span> = <span class="ruby-identifier">write_file</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">spec_file</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">io</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">to_ruby_for_cache</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">loaded_from</span> = <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">loaded_from</span> = <span class="ruby-identifier">written_path</span>

  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">add_spec</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">for_cache</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">spec</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- quick_gem-source -->
            
          </div>

          

          
        </div><!-- quick_gem-method -->

      
        <div id="quick_spec-method" class="method-detail ">
          <a name="method-i-quick_spec"></a>

          
          <div class="method-heading">
            <span class="method-name">quick_spec</span><span
              class="method-args">(name, version = '2')</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="quick_spec-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 412</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">quick_spec</span> <span class="ruby-identifier">name</span>, <span class="ruby-identifier">version</span> = <span class="ruby-string">'2'</span>
  <span class="ruby-comment"># TODO: deprecate</span>
  <span class="ruby-identifier">require</span> <span class="ruby-string">'rubygems/specification'</span>

  <span class="ruby-identifier">spec</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">platform</span>    = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Platform</span><span class="ruby-operator">::</span><span class="ruby-constant">RUBY</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">name</span>        = <span class="ruby-identifier">name</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">version</span>     = <span class="ruby-identifier">version</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">author</span>      = <span class="ruby-string">'A User'</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">email</span>       = <span class="ruby-string">'example@example.com'</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">homepage</span>    = <span class="ruby-string">'http://example.com'</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">summary</span>     = <span class="ruby-string">&quot;this is a summary&quot;</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">description</span> = <span class="ruby-string">&quot;This is a test description&quot;</span>

    <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">s</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">loaded_from</span> = <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">spec_file</span>

  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">add_spec</span> <span class="ruby-identifier">spec</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">spec</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- quick_spec-source -->
            
          </div>

          

          
        </div><!-- quick_spec-method -->

      
        <div id="read_binary-method" class="method-detail ">
          <a name="method-i-read_binary"></a>

          
          <div class="method-heading">
            <span class="method-name">read_binary</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Reads a binary file at <tt>path</tt></p>
            

            
            <div class="method-source-code" id="read_binary-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 350</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">read_binary</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">read_binary</span> <span class="ruby-identifier">path</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- read_binary-source -->
            
          </div>

          

          
        </div><!-- read_binary-method -->

      
        <div id="read_cache-method" class="method-detail ">
          <a name="method-i-read_cache"></a>

          
          <div class="method-heading">
            <span class="method-name">read_cache</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Reads a Marshal file at <tt>path</tt></p>
            

            
            <div class="method-source-code" id="read_cache-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 341</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">read_cache</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">open</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">untaint</span>, <span class="ruby-string">'rb'</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">load</span> <span class="ruby-identifier">io</span>.<span class="ruby-identifier">read</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- read_cache-source -->
            
          </div>

          

          
        </div><!-- read_cache-method -->

      
        <div id="refute_path_exists-method" class="method-detail ">
          <a name="method-i-refute_path_exists"></a>

          
          <div class="method-heading">
            <span class="method-name">refute_path_exists</span><span
              class="method-args">(path, msg = nil)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>TODO: move to minitest</p>
            

            
            <div class="method-source-code" id="refute_path_exists-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 87</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">refute_path_exists</span> <span class="ruby-identifier">path</span>, <span class="ruby-identifier">msg</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">msg</span> = <span class="ruby-identifier">message</span>(<span class="ruby-identifier">msg</span>) { <span class="ruby-node">&quot;Expected path '#{path}' to not exist&quot;</span> }
  <span class="ruby-identifier">refute</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-identifier">path</span>), <span class="ruby-identifier">msg</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- refute_path_exists-source -->
            
          </div>

          

          
        </div><!-- refute_path_exists-method -->

      
        <div id="req-method" class="method-detail ">
          <a name="method-i-req"></a>

          
          <div class="method-heading">
            <span class="method-name">req</span><span
              class="method-args">(*requirements)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Constructs a new <a href="Requirement.html">Gem::Requirement</a>.</p>
            

            
            <div class="method-source-code" id="req-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 953</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">req</span> *<span class="ruby-identifier">requirements</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">requirements</span>.<span class="ruby-identifier">first</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Requirement</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">requirements</span>.<span class="ruby-identifier">first</span>
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Requirement</span>.<span class="ruby-identifier">create</span> <span class="ruby-identifier">requirements</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- req-source -->
            
          </div>

          

          
        </div><!-- req-method -->

      
        <div id="setup-method" class="method-detail ">
          <a name="method-i-setup"></a>

          
          <div class="method-heading">
            <span class="method-name">setup</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p><a href="TestCase.html#method-i-setup">setup</a> prepares a sandboxed
location to install gems.  All installs are directed to a temporary
directory.  All install plugins are removed.</p>

<p>If the <tt>RUBY</tt> environment variable is set the given path is used for
<a href="../Gem.html#method-c-ruby">Gem::ruby</a>.  The local platform is
set to <tt>i386-mswin32</tt> for Windows or <tt>i686-darwin8.10.1</tt>
otherwise.</p>

<p>If the <tt>KEEP_FILES</tt> environment variable is set the files will not
be removed from <tt>/tmp/test_rubygems_#{$$}.#{Time.now.to_i}</tt>.</p>
            

            
            <div class="method-source-code" id="setup-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 112</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">setup</span>
  <span class="ruby-keyword">super</span>

  <span class="ruby-ivar">@orig_gem_home</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-string">'GEM_HOME'</span>]
  <span class="ruby-ivar">@orig_gem_path</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-string">'GEM_PATH'</span>]

  <span class="ruby-ivar">@current_dir</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">pwd</span>
  <span class="ruby-ivar">@ui</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">MockGemUi</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-identifier">tmpdir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span> <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">tmpdir</span>
  <span class="ruby-identifier">tmpdir</span>.<span class="ruby-identifier">untaint</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">'KEEP_FILES'</span>] <span class="ruby-keyword">then</span>
    <span class="ruby-ivar">@tempdir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">tmpdir</span>, <span class="ruby-node">&quot;test_rubygems_#{$$}.#{Time.now.to_i}&quot;</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@tempdir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">tmpdir</span>, <span class="ruby-node">&quot;test_rubygems_#{$$}&quot;</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@tempdir</span>.<span class="ruby-identifier">untaint</span>

  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-ivar">@tempdir</span>

  <span class="ruby-comment"># This makes the tempdir consistent on OS X.</span>
  <span class="ruby-comment"># File.expand_path Dir.tmpdir                      #=&gt; &quot;/var/...&quot;</span>
  <span class="ruby-comment"># Dir.chdir Dir.tmpdir do File.expand_path '.' end #=&gt; &quot;/private/var/...&quot;</span>
  <span class="ruby-comment"># TODO use File#realpath above instead of #expand_path once 1.8 support is</span>
  <span class="ruby-comment"># dropped.</span>
  <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span> <span class="ruby-ivar">@tempdir</span> <span class="ruby-keyword">do</span>
    <span class="ruby-ivar">@tempdir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span> <span class="ruby-string">'.'</span>
    <span class="ruby-ivar">@tempdir</span>.<span class="ruby-identifier">untaint</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@gemhome</span>  = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-ivar">@tempdir</span>, <span class="ruby-string">'gemhome'</span>
  <span class="ruby-ivar">@userhome</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-ivar">@tempdir</span>, <span class="ruby-string">'userhome'</span>

  <span class="ruby-ivar">@orig_ruby</span> = <span class="ruby-keyword">if</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">'RUBY'</span>] <span class="ruby-keyword">then</span>
                 <span class="ruby-identifier">ruby</span> = <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">instance_variable_get</span> <span class="ruby-value">:@ruby</span>
                 <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">instance_variable_set</span> <span class="ruby-value">:@ruby</span>, <span class="ruby-constant">ENV</span>[<span class="ruby-string">'RUBY'</span>]
                 <span class="ruby-identifier">ruby</span>
               <span class="ruby-keyword">end</span>

  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">ensure_gem_subdirectories</span> <span class="ruby-ivar">@gemhome</span>

  <span class="ruby-ivar">@orig_LOAD_PATH</span> = <span class="ruby-identifier">$LOAD_PATH</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">$LOAD_PATH</span>.<span class="ruby-identifier">map!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">s</span>).<span class="ruby-identifier">untaint</span> }

  <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span> <span class="ruby-ivar">@tempdir</span>

  <span class="ruby-ivar">@orig_ENV_HOME</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-string">'HOME'</span>]
  <span class="ruby-constant">ENV</span>[<span class="ruby-string">'HOME'</span>] = <span class="ruby-ivar">@userhome</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">instance_variable_set</span> <span class="ruby-value">:@user_home</span>, <span class="ruby-keyword">nil</span>

  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-ivar">@gemhome</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-ivar">@userhome</span>

  <span class="ruby-ivar">@default_dir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-ivar">@tempdir</span>, <span class="ruby-string">'default'</span>
  <span class="ruby-ivar">@default_spec_dir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-ivar">@default_dir</span>, <span class="ruby-string">&quot;specifications&quot;</span>, <span class="ruby-string">&quot;default&quot;</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">instance_variable_set</span> <span class="ruby-value">:@default_dir</span>, <span class="ruby-ivar">@default_dir</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-ivar">@default_spec_dir</span>

  <span class="ruby-comment"># We use Gem::Specification.reset the first time only so that if there</span>
  <span class="ruby-comment"># are unresolved deps that leak into the whole test suite, they're at least</span>
  <span class="ruby-comment"># reported once.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">@@initial_reset</span>
    <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">unresolved_deps</span>.<span class="ruby-identifier">clear</span> <span class="ruby-comment"># done to avoid cross-test warnings</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">@@initial_reset</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">reset</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">use_paths</span>(<span class="ruby-ivar">@gemhome</span>)

  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Security</span>.<span class="ruby-identifier">reset</span>

  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">loaded_specs</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">clear_default_specs</span>
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">unresolved_deps</span>.<span class="ruby-identifier">clear</span>

  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">verbose</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">update_sources</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">RemoteFetcher</span>.<span class="ruby-identifier">fetcher</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">FakeFetcher</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-ivar">@gem_repo</span> = <span class="ruby-string">&quot;http://gems.example.com/&quot;</span>
  <span class="ruby-ivar">@uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span> <span class="ruby-ivar">@gem_repo</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">sources</span>.<span class="ruby-identifier">replace</span> [<span class="ruby-ivar">@gem_repo</span>]

  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">searcher</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">SpecFetcher</span>.<span class="ruby-identifier">fetcher</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@orig_BASERUBY</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">ConfigMap</span>[<span class="ruby-value">:BASERUBY</span>]
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">ConfigMap</span>[<span class="ruby-value">:BASERUBY</span>] = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">ConfigMap</span>[<span class="ruby-value">:ruby_install_name</span>]

  <span class="ruby-ivar">@orig_arch</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">ConfigMap</span>[<span class="ruby-value">:arch</span>]

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">win_platform?</span>
    <span class="ruby-identifier">util_set_arch</span> <span class="ruby-string">'i386-mswin32'</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">util_set_arch</span> <span class="ruby-string">'i686-darwin8.10.1'</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@marshal_version</span> = <span class="ruby-node">&quot;#{Marshal::MAJOR_VERSION}.#{Marshal::MINOR_VERSION}&quot;</span>

  <span class="ruby-comment"># TODO: move to installer test cases</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">post_build_hooks</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">post_install_hooks</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">done_installing_hooks</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">post_reset_hooks</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">post_uninstall_hooks</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">pre_install_hooks</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">pre_reset_hooks</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">pre_uninstall_hooks</span>.<span class="ruby-identifier">clear</span>

  <span class="ruby-comment"># TODO: move to installer test cases</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">post_build</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">installer</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@post_build_hook_arg</span> = <span class="ruby-identifier">installer</span>
    <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">post_install</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">installer</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@post_install_hook_arg</span> = <span class="ruby-identifier">installer</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">post_uninstall</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">uninstaller</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@post_uninstall_hook_arg</span> = <span class="ruby-identifier">uninstaller</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">pre_install</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">installer</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@pre_install_hook_arg</span> = <span class="ruby-identifier">installer</span>
    <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">pre_uninstall</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">uninstaller</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@pre_uninstall_hook_arg</span> = <span class="ruby-identifier">uninstaller</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- setup-source -->
            
          </div>

          

          
        </div><!-- setup-method -->

      
        <div id="spec-method" class="method-detail ">
          <a name="method-i-spec"></a>

          
          <div class="method-heading">
            <span class="method-name">spec</span><span
              class="method-args">(name, version, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Constructs a new <a href="Specification.html">Gem::Specification</a>.</p>
            

            
            <div class="method-source-code" id="spec-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 961</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">spec</span> <span class="ruby-identifier">name</span>, <span class="ruby-identifier">version</span>, &amp;<span class="ruby-identifier">block</span>
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">name</span>, <span class="ruby-identifier">v</span>(<span class="ruby-identifier">version</span>), &amp;<span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- spec-source -->
            
          </div>

          

          
        </div><!-- spec-method -->

      
        <div id="teardown-method" class="method-detail ">
          <a name="method-i-teardown"></a>

          
          <div class="method-heading">
            <span class="method-name">teardown</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p><a href="TestCase.html#method-i-teardown">teardown</a> restores the process
to its original state and removes the tempdir unless the
<tt>KEEP_FILES</tt> environment variable was set.</p>
            

            
            <div class="method-source-code" id="teardown-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 250</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">teardown</span>
  <span class="ruby-identifier">$LOAD_PATH</span>.<span class="ruby-identifier">replace</span> <span class="ruby-ivar">@orig_LOAD_PATH</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@orig_LOAD_PATH</span>

  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">ConfigMap</span>[<span class="ruby-value">:BASERUBY</span>] = <span class="ruby-ivar">@orig_BASERUBY</span>
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">ConfigMap</span>[<span class="ruby-value">:arch</span>] = <span class="ruby-ivar">@orig_arch</span>

  <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">RemoteFetcher</span> <span class="ruby-keyword">then</span>
    <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">RemoteFetcher</span>.<span class="ruby-identifier">fetcher</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span> <span class="ruby-ivar">@current_dir</span>

  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_rf</span> <span class="ruby-ivar">@tempdir</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">'KEEP_FILES'</span>]

  <span class="ruby-constant">ENV</span>[<span class="ruby-string">'GEM_HOME'</span>] = <span class="ruby-ivar">@orig_gem_home</span>
  <span class="ruby-constant">ENV</span>[<span class="ruby-string">'GEM_PATH'</span>] = <span class="ruby-ivar">@orig_gem_path</span>

  <span class="ruby-identifier">_</span> = <span class="ruby-ivar">@orig_ruby</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">instance_variable_set</span> <span class="ruby-value">:@ruby</span>, <span class="ruby-ivar">@orig_ruby</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@orig_ruby</span>

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@orig_ENV_HOME</span> <span class="ruby-keyword">then</span>
    <span class="ruby-constant">ENV</span>[<span class="ruby-string">'HOME'</span>] = <span class="ruby-ivar">@orig_ENV_HOME</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-constant">ENV</span>.<span class="ruby-identifier">delete</span> <span class="ruby-string">'HOME'</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">instance_variable_set</span> <span class="ruby-value">:@default_dir</span>, <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- teardown-source -->
            
          </div>

          

          
        </div><!-- teardown-method -->

      
        <div id="uninstall_gem-method" class="method-detail ">
          <a name="method-i-uninstall_gem"></a>

          
          <div class="method-heading">
            <span class="method-name">uninstall_gem</span><span
              class="method-args">(spec)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Uninstalls the <a href="Specification.html">Gem::Specification</a>
<tt>spec</tt></p>
            

            
            <div class="method-source-code" id="uninstall_gem-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 309</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">uninstall_gem</span> <span class="ruby-identifier">spec</span>
  <span class="ruby-identifier">require</span> <span class="ruby-string">'rubygems/uninstaller'</span>

  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Uninstaller</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">spec</span>.<span class="ruby-identifier">name</span>,
                       <span class="ruby-value">:executables</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>, <span class="ruby-value">:user_install</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>).<span class="ruby-identifier">uninstall</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- uninstall_gem-source -->
            
          </div>

          

          
        </div><!-- uninstall_gem-method -->

      
        <div id="util_build_gem-method" class="method-detail ">
          <a name="method-i-util_build_gem"></a>

          
          <div class="method-heading">
            <span class="method-name">util_build_gem</span><span
              class="method-args">(spec)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Builds a gem from <tt>spec</tt> and places it in <tt>File.join @gemhome,
'cache'</tt>.  Automatically creates files based on <tt>spec.files</tt></p>
            

            
            <div class="method-source-code" id="util_build_gem-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 440</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">util_build_gem</span>(<span class="ruby-identifier">spec</span>)
  <span class="ruby-identifier">dir</span> = <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">gem_dir</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-identifier">dir</span>

  <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span> <span class="ruby-identifier">dir</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">files</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">file</span>
      <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">file</span>)
      <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span> <span class="ruby-identifier">file</span>, <span class="ruby-string">'w'</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">fp</span><span class="ruby-operator">|</span> <span class="ruby-identifier">fp</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;# #{file}&quot;</span> <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">use_ui</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">MockGemUi</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span>
      <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Package</span>.<span class="ruby-identifier">build</span> <span class="ruby-identifier">spec</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">cache</span> = <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">cache_file</span>
    <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mv</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">cache</span>), <span class="ruby-identifier">cache</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- util_build_gem-source -->
            
          </div>

          

          
        </div><!-- util_build_gem-method -->

      
        <div id="util_clear_gems-method" class="method-detail ">
          <a name="method-i-util_clear_gems"></a>

          
          <div class="method-heading">
            <span class="method-name">util_clear_gems</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Removes all installed gems from +@gemhome+.</p>
            

            
            <div class="method-source-code" id="util_clear_gems-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 468</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">util_clear_gems</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_rf</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@gemhome</span>, <span class="ruby-string">&quot;gems&quot;</span>) <span class="ruby-comment"># TODO: use Gem::Dirs</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_rf</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@gemhome</span>, <span class="ruby-string">&quot;specifications&quot;</span>)
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">reset</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- util_clear_gems-source -->
            
          </div>

          

          
        </div><!-- util_clear_gems-method -->

      
        <div id="util_gem-method" class="method-detail ">
          <a name="method-i-util_gem"></a>

          
          <div class="method-heading">
            <span class="method-name">util_gem</span><span
              class="method-args">(name, version, deps = nil, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Creates a gem with <tt>name</tt>, <tt>version</tt> and <tt>deps</tt>.  The
specification will be yielded before gem creation for customization.  The
gem will be placed in <tt>File.join @tempdir, 'gems'</tt>.  The
specification and .gem file location are returned.</p>
            

            
            <div class="method-source-code" id="util_gem-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 594</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">util_gem</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">version</span>, <span class="ruby-identifier">deps</span> = <span class="ruby-keyword">nil</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-comment"># TODO: deprecate</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;deps or block, not both&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">deps</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">block</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">deps</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">block</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
      <span class="ruby-comment"># Since Hash#each is unordered in 1.8, sort</span>
      <span class="ruby-comment"># the keys and iterate that way so the tests are</span>
      <span class="ruby-comment"># deterministic on all implementations.</span>
      <span class="ruby-identifier">deps</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">s</span>.<span class="ruby-identifier">add_dependency</span> <span class="ruby-identifier">n</span>, (<span class="ruby-identifier">deps</span>[<span class="ruby-identifier">n</span>] <span class="ruby-operator">||</span> <span class="ruby-string">'&gt;= 0'</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">spec</span> = <span class="ruby-identifier">quick_gem</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">version</span>, &amp;<span class="ruby-identifier">block</span>)

  <span class="ruby-identifier">util_build_gem</span> <span class="ruby-identifier">spec</span>

  <span class="ruby-identifier">cache_file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-ivar">@tempdir</span>, <span class="ruby-string">'gems'</span>, <span class="ruby-node">&quot;#{spec.original_name}.gem&quot;</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span> <span class="ruby-identifier">cache_file</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mv</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">cache_file</span>, <span class="ruby-identifier">cache_file</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">spec_file</span>

  <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">loaded_from</span> = <span class="ruby-keyword">nil</span>

  [<span class="ruby-identifier">spec</span>, <span class="ruby-identifier">cache_file</span>]
<span class="ruby-keyword">end</span></pre>
            </div><!-- util_gem-source -->
            
          </div>

          

          
        </div><!-- util_gem-method -->

      
        <div id="util_gzip-method" class="method-detail ">
          <a name="method-i-util_gzip"></a>

          
          <div class="method-heading">
            <span class="method-name">util_gzip</span><span
              class="method-args">(data)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Gzips <tt>data</tt>.</p>
            

            
            <div class="method-source-code" id="util_gzip-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 626</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">util_gzip</span>(<span class="ruby-identifier">data</span>)
  <span class="ruby-identifier">out</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-constant">Zlib</span><span class="ruby-operator">::</span><span class="ruby-constant">GzipWriter</span>.<span class="ruby-identifier">wrap</span> <span class="ruby-identifier">out</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">io</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">data</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">out</span>.<span class="ruby-identifier">string</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- util_gzip-source -->
            
          </div>

          

          
        </div><!-- util_gzip-method -->

      
        <div id="util_make_gems-method" class="method-detail ">
          <a name="method-i-util_make_gems"></a>

          
          <div class="method-heading">
            <span class="method-name">util_make_gems</span><span
              class="method-args">(prerelease = false)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Creates several default gems which all have a lib/code.rb file.  The gems
are not installed but are available in the cache dir.</p>
<table class="rdoc-list"><tr><td class="rdoc-term"><p>+@a1+</p></td>
<td>
<p>gem a version 1, this is the best-described gem.</p>
</td></tr><tr><td class="rdoc-term"><p>+@a2+</p></td>
<td>
<p>gem a version 2</p>
</td></tr><tr><td class="rdoc-term"><p>+@a3a</p></td>
<td>
<p>gem a version 3.a</p>
</td></tr><tr><td class="rdoc-term"><p>+@a_evil9+</p></td>
<td>
<p>gem a_evil version 9, use this to ensure similarly-named gems don’t collide
with a.</p>
</td></tr><tr><td class="rdoc-term"><p>+@b2+</p></td>
<td>
<p>gem b version 2</p>
</td></tr><tr><td class="rdoc-term"><p>+@c1_2+</p></td>
<td>
<p>gem c version 1.2</p>
</td></tr><tr><td class="rdoc-term"><p>+@pl1+</p></td>
<td>
<p>gem pl version 1, this gem has a legacy platform of i386-linux.</p>
</td></tr></table>

<p>Additional <tt>prerelease</tt> gems may also be created:</p>
<table class="rdoc-list"><tr><td class="rdoc-term"><p>+@a2_pre+</p></td>
<td>
<p>gem a version 2.a</p>
</td></tr></table>

<p>TODO: nuke this and fix tests. this should speed up a lot</p>
            

            
            <div class="method-source-code" id="util_make_gems-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 654</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">util_make_gems</span>(<span class="ruby-identifier">prerelease</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-ivar">@a1</span> = <span class="ruby-identifier">quick_gem</span> <span class="ruby-string">'a'</span>, <span class="ruby-string">'1'</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">files</span> = <span class="ruby-node">]lib/code.rb]</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">require_paths</span> = <span class="ruby-node">]lib]</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">date</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span><span class="ruby-operator">::</span><span class="ruby-constant">TODAY</span> <span class="ruby-operator">-</span> <span class="ruby-value">86400</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">homepage</span> = <span class="ruby-string">'http://a.example.com'</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">email</span> = <span class="ruby-node">]example@example.com example2@example.com]</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">authors</span> = <span class="ruby-node">]Example Example2]</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">description</span> = <span class="ruby-string">This line is really, really long.  So long, in fact, that it is more than eighty characters long!  The purpose of this line is for testing wrapping behavior because sometimes people don't wrap their text to eighty characters.  Without the wrapping, the text might not look good in the RSS feed.Also, a list:  * An entry that\'s actually kind of sort  * an entry that\'s really long, which will probably get wrapped funny.  That's ok, somebody wasn't thinking straight when they made it more than eighty characters.</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">init</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">files</span> = <span class="ruby-node">]lib/code.rb]</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">require_paths</span> = <span class="ruby-node">]lib]</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@a2</span>      = <span class="ruby-identifier">quick_gem</span>(<span class="ruby-string">'a'</span>, <span class="ruby-string">'2'</span>,      &amp;<span class="ruby-identifier">init</span>)
  <span class="ruby-ivar">@a3a</span>     = <span class="ruby-identifier">quick_gem</span>(<span class="ruby-string">'a'</span>, <span class="ruby-string">'3.a'</span>,    &amp;<span class="ruby-identifier">init</span>)
  <span class="ruby-ivar">@a_evil9</span> = <span class="ruby-identifier">quick_gem</span>(<span class="ruby-string">'a_evil'</span>, <span class="ruby-string">'9'</span>, &amp;<span class="ruby-identifier">init</span>)
  <span class="ruby-ivar">@b2</span>      = <span class="ruby-identifier">quick_gem</span>(<span class="ruby-string">'b'</span>, <span class="ruby-string">'2'</span>,      &amp;<span class="ruby-identifier">init</span>)
  <span class="ruby-ivar">@c1_2</span>    = <span class="ruby-identifier">quick_gem</span>(<span class="ruby-string">'c'</span>, <span class="ruby-string">'1.2'</span>,    &amp;<span class="ruby-identifier">init</span>)
  <span class="ruby-ivar">@x</span>       = <span class="ruby-identifier">quick_gem</span>(<span class="ruby-string">'x'</span>, <span class="ruby-string">'1'</span>, &amp;<span class="ruby-identifier">init</span>)
  <span class="ruby-ivar">@dep_x</span>   = <span class="ruby-identifier">quick_gem</span>(<span class="ruby-string">'dep_x'</span>, <span class="ruby-string">'1'</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">files</span> = <span class="ruby-node">]lib/code.rb]</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">require_paths</span> = <span class="ruby-node">]lib]</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">add_dependency</span> <span class="ruby-string">'x'</span>, <span class="ruby-string">'&gt;= 1'</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@pl1</span>     = <span class="ruby-identifier">quick_gem</span> <span class="ruby-string">'pl'</span>, <span class="ruby-string">'1'</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-comment"># l for legacy</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">files</span> = <span class="ruby-node">]lib/code.rb]</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">require_paths</span> = <span class="ruby-node">]lib]</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">platform</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Platform</span>.<span class="ruby-identifier">new</span> <span class="ruby-string">'i386-linux'</span>
    <span class="ruby-identifier">s</span>.<span class="ruby-identifier">instance_variable_set</span> <span class="ruby-value">:@original_platform</span>, <span class="ruby-string">'i386-linux'</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">prerelease</span>
    <span class="ruby-ivar">@a2_pre</span> = <span class="ruby-identifier">quick_gem</span>(<span class="ruby-string">'a'</span>, <span class="ruby-string">'2.a'</span>, &amp;<span class="ruby-identifier">init</span>)
    <span class="ruby-identifier">write_file</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(*<span class="ruby-node">]gems #{@a2_pre.original_name} lib code.rb]</span>)
    <span class="ruby-identifier">util_build_gem</span> <span class="ruby-ivar">@a2_pre</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">write_file</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(*<span class="ruby-node">]gems #{@a1.original_name}   lib code.rb]</span>)
  <span class="ruby-identifier">write_file</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(*<span class="ruby-node">]gems #{@a2.original_name}   lib code.rb]</span>)
  <span class="ruby-identifier">write_file</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(*<span class="ruby-node">]gems #{@a3a.original_name}  lib code.rb]</span>)
  <span class="ruby-identifier">write_file</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(*<span class="ruby-node">]gems #{@b2.original_name}   lib code.rb]</span>)
  <span class="ruby-identifier">write_file</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(*<span class="ruby-node">]gems #{@c1_2.original_name} lib code.rb]</span>)
  <span class="ruby-identifier">write_file</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(*<span class="ruby-node">]gems #{@pl1.original_name}  lib code.rb]</span>)
  <span class="ruby-identifier">write_file</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(*<span class="ruby-node">]gems #{@x.original_name}  lib code.rb]</span>)
  <span class="ruby-identifier">write_file</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(*<span class="ruby-node">]gems #{@dep_x.original_name}  lib code.rb]</span>)

  [<span class="ruby-ivar">@a1</span>, <span class="ruby-ivar">@a2</span>, <span class="ruby-ivar">@a3a</span>, <span class="ruby-ivar">@a_evil9</span>, <span class="ruby-ivar">@b2</span>, <span class="ruby-ivar">@c1_2</span>, <span class="ruby-ivar">@pl1</span>, <span class="ruby-ivar">@x</span>, <span class="ruby-ivar">@dep_x</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spec</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">util_build_gem</span> <span class="ruby-identifier">spec</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_r</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@gemhome</span>, <span class="ruby-string">&quot;gems&quot;</span>, <span class="ruby-ivar">@pl1</span>.<span class="ruby-identifier">original_name</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- util_make_gems-source -->
            
          </div>

          

          
        </div><!-- util_make_gems-method -->

      
        <div id="util_remove_gem-method" class="method-detail ">
          <a name="method-i-util_remove_gem"></a>

          
          <div class="method-heading">
            <span class="method-name">util_remove_gem</span><span
              class="method-args">(spec)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="util_remove_gem-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 460</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">util_remove_gem</span>(<span class="ruby-identifier">spec</span>)
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_rf</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">cache_file</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_rf</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">spec_file</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- util_remove_gem-source -->
            
          </div>

          

          
        </div><!-- util_remove_gem-method -->

      
        <div id="util_set_arch-method" class="method-detail ">
          <a name="method-i-util_set_arch"></a>

          
          <div class="method-heading">
            <span class="method-name">util_set_arch</span><span
              class="method-args">(arch)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Set the platform to <tt>arch</tt></p>
            

            
            <div class="method-source-code" id="util_set_arch-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 720</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">util_set_arch</span>(<span class="ruby-identifier">arch</span>)
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">ConfigMap</span>[<span class="ruby-value">:arch</span>] = <span class="ruby-identifier">arch</span>
  <span class="ruby-identifier">platform</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Platform</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">arch</span>

  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">instance_variable_set</span> <span class="ruby-value">:@platforms</span>, <span class="ruby-keyword">nil</span>
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Platform</span>.<span class="ruby-identifier">instance_variable_set</span> <span class="ruby-value">:@local</span>, <span class="ruby-keyword">nil</span>

  <span class="ruby-identifier">platform</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- util_set_arch-source -->
            
          </div>

          

          
        </div><!-- util_set_arch-method -->

      
        <div id="util_setup_fake_fetcher-method" class="method-detail ">
          <a name="method-i-util_setup_fake_fetcher"></a>

          
          <div class="method-heading">
            <span class="method-name">util_setup_fake_fetcher</span><span
              class="method-args">(prerelease = false)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets up a fake fetcher using the gems from <a
href="TestCase.html#method-i-util_make_gems">util_make_gems</a>. 
Optionally additional <tt>prerelease</tt> gems may be included.</p>

<p>Gems created by this method may be fetched using <a
href="RemoteFetcher.html">Gem::RemoteFetcher</a>.</p>
            

            
            <div class="method-source-code" id="util_setup_fake_fetcher-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 736</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">util_setup_fake_fetcher</span>(<span class="ruby-identifier">prerelease</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">require</span> <span class="ruby-string">'zlib'</span>
  <span class="ruby-identifier">require</span> <span class="ruby-string">'socket'</span>
  <span class="ruby-identifier">require</span> <span class="ruby-string">'rubygems/remote_fetcher'</span>

  <span class="ruby-ivar">@fetcher</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">FakeFetcher</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-identifier">util_make_gems</span>(<span class="ruby-identifier">prerelease</span>)
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">reset</span>

  <span class="ruby-ivar">@all_gems</span> = [<span class="ruby-ivar">@a1</span>, <span class="ruby-ivar">@a2</span>, <span class="ruby-ivar">@a3a</span>, <span class="ruby-ivar">@a_evil9</span>, <span class="ruby-ivar">@b2</span>, <span class="ruby-ivar">@c1_2</span>].<span class="ruby-identifier">sort</span>
  <span class="ruby-ivar">@all_gem_names</span> = <span class="ruby-ivar">@all_gems</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">gem</span><span class="ruby-operator">|</span> <span class="ruby-identifier">gem</span>.<span class="ruby-identifier">full_name</span> }

  <span class="ruby-identifier">gem_names</span> = [<span class="ruby-ivar">@a1</span>.<span class="ruby-identifier">full_name</span>, <span class="ruby-ivar">@a2</span>.<span class="ruby-identifier">full_name</span>, <span class="ruby-ivar">@a3a</span>.<span class="ruby-identifier">full_name</span>, <span class="ruby-ivar">@b2</span>.<span class="ruby-identifier">full_name</span>]
  <span class="ruby-ivar">@gem_names</span> = <span class="ruby-identifier">gem_names</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;\n&quot;</span>)

  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">RemoteFetcher</span>.<span class="ruby-identifier">fetcher</span> = <span class="ruby-ivar">@fetcher</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- util_setup_fake_fetcher-source -->
            
          </div>

          

          
        </div><!-- util_setup_fake_fetcher-method -->

      
        <div id="util_setup_spec_fetcher-method" class="method-detail ">
          <a name="method-i-util_setup_spec_fetcher"></a>

          
          <div class="method-heading">
            <span class="method-name">util_setup_spec_fetcher</span><span
              class="method-args">(*specs)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets up <a href="SpecFetcher.html">Gem::SpecFetcher</a> to return
information from the gems in <tt>specs</tt>. Best used with +@all_gems+
from <a
href="TestCase.html#method-i-util_setup_fake_fetcher">util_setup_fake_fetcher</a>.</p>
            

            
            <div class="method-source-code" id="util_setup_spec_fetcher-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 768</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">util_setup_spec_fetcher</span>(*<span class="ruby-identifier">specs</span>)
  <span class="ruby-identifier">specs</span> <span class="ruby-operator">-=</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">_all</span>
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">add_specs</span>(*<span class="ruby-identifier">specs</span>)

  <span class="ruby-identifier">spec_fetcher</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">SpecFetcher</span>.<span class="ruby-identifier">fetcher</span>

  <span class="ruby-identifier">prerelease</span>, <span class="ruby-identifier">all</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">partition</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">spec</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">version</span>.<span class="ruby-identifier">prerelease?</span>
  }

  <span class="ruby-identifier">spec_fetcher</span>.<span class="ruby-identifier">specs</span>[<span class="ruby-ivar">@uri</span>] = []
  <span class="ruby-identifier">all</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spec</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">spec_fetcher</span>.<span class="ruby-identifier">specs</span>[<span class="ruby-ivar">@uri</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">name_tuple</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">spec_fetcher</span>.<span class="ruby-identifier">latest_specs</span>[<span class="ruby-ivar">@uri</span>] = []
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">latest_specs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spec</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">spec_fetcher</span>.<span class="ruby-identifier">latest_specs</span>[<span class="ruby-ivar">@uri</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">name_tuple</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">spec_fetcher</span>.<span class="ruby-identifier">prerelease_specs</span>[<span class="ruby-ivar">@uri</span>] = []
  <span class="ruby-identifier">prerelease</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spec</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">spec_fetcher</span>.<span class="ruby-identifier">prerelease_specs</span>[<span class="ruby-ivar">@uri</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">name_tuple</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">v</span> = <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">marshal_version</span>

  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spec</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">path</span> = <span class="ruby-node">&quot;#{@gem_repo}quick/Marshal.#{v}/#{spec.original_name}.gemspec.rz&quot;</span>
    <span class="ruby-identifier">data</span> = <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">dump</span> <span class="ruby-identifier">spec</span>
    <span class="ruby-identifier">data_deflate</span> = <span class="ruby-constant">Zlib</span><span class="ruby-operator">::</span><span class="ruby-constant">Deflate</span>.<span class="ruby-identifier">deflate</span> <span class="ruby-identifier">data</span>
    <span class="ruby-ivar">@fetcher</span>.<span class="ruby-identifier">data</span>[<span class="ruby-identifier">path</span>] = <span class="ruby-identifier">data_deflate</span>
  <span class="ruby-keyword">end</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">RemoteFetcher</span> <span class="ruby-operator">===</span> <span class="ruby-ivar">@fetcher</span> <span class="ruby-comment"># HACK for test_download_to_cache</span>

  <span class="ruby-keyword">nil</span> <span class="ruby-comment"># force errors</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- util_setup_spec_fetcher-source -->
            
          </div>

          

          
        </div><!-- util_setup_spec_fetcher-method -->

      
        <div id="util_spec-method" class="method-detail ">
          <a name="method-i-util_spec"></a>

          
          <div class="method-heading">
            <span class="method-name">util_spec</span><span
              class="method-args">(name, version, deps = nil, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Creates a spec with <tt>name</tt>, <tt>version</tt> and <tt>deps</tt>.</p>
            

            
            <div class="method-source-code" id="util_spec-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 570</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">util_spec</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">version</span>, <span class="ruby-identifier">deps</span> = <span class="ruby-keyword">nil</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-comment"># TODO: deprecate</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;deps or block, not both&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">deps</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">block</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">deps</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">block</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
      <span class="ruby-comment"># Since Hash#each is unordered in 1.8, sort</span>
      <span class="ruby-comment"># the keys and iterate that way so the tests are</span>
      <span class="ruby-comment"># deteriminstic on all implementations.</span>
      <span class="ruby-identifier">deps</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">s</span>.<span class="ruby-identifier">add_dependency</span> <span class="ruby-identifier">n</span>, (<span class="ruby-identifier">deps</span>[<span class="ruby-identifier">n</span>] <span class="ruby-operator">||</span> <span class="ruby-string">'&gt;= 0'</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">quick_spec</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">version</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- util_spec-source -->
            
          </div>

          

          
        </div><!-- util_spec-method -->

      
        <div id="util_zip-method" class="method-detail ">
          <a name="method-i-util_zip"></a>

          
          <div class="method-heading">
            <span class="method-name">util_zip</span><span
              class="method-args">(data)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Deflates <tt>data</tt></p>
            

            
            <div class="method-source-code" id="util_zip-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 808</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">util_zip</span>(<span class="ruby-identifier">data</span>)
  <span class="ruby-constant">Zlib</span><span class="ruby-operator">::</span><span class="ruby-constant">Deflate</span>.<span class="ruby-identifier">deflate</span> <span class="ruby-identifier">data</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- util_zip-source -->
            
          </div>

          

          
        </div><!-- util_zip-method -->

      
        <div id="v-method" class="method-detail ">
          <a name="method-i-v"></a>

          
          <div class="method-heading">
            <span class="method-name">v</span><span
              class="method-args">(string)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Construct a new <a href="Version.html">Gem::Version</a>.</p>
            

            
            <div class="method-source-code" id="v-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 968</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">v</span> <span class="ruby-identifier">string</span>
  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">create</span> <span class="ruby-identifier">string</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- v-source -->
            
          </div>

          

          
        </div><!-- v-method -->

      
        <div id="vc_windows-3F-method" class="method-detail ">
          <a name="method-i-vc_windows-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">vc_windows?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns whether or not we’re on a version of Ruby built with VC++ (or
Borland) versus Cygwin, Mingw, etc.</p>
            

            
            <div class="method-source-code" id="vc_windows-3F-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 838</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vc_windows?</span>
  <span class="ruby-constant">RUBY_PLATFORM</span>.<span class="ruby-identifier">match</span>(<span class="ruby-string">'mswin'</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- vc_windows-3F-source -->
            
          </div>

          

          
        </div><!-- vc_windows-3F-method -->

      
        <div id="wait_for_child_process_to_exit-method" class="method-detail ">
          <a name="method-i-wait_for_child_process_to_exit"></a>

          
          <div class="method-heading">
            <span class="method-name">wait_for_child_process_to_exit</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>In case we’re building docs in a background process, this method waits for
that process to exit (or if it’s already been reaped, or never happened,
swallows the Errno::ECHILD error).</p>
            

            
            <div class="method-source-code" id="wait_for_child_process_to_exit-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 870</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">wait_for_child_process_to_exit</span>
  <span class="ruby-constant">Process</span>.<span class="ruby-identifier">wait</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">Process</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:fork</span>)
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">ECHILD</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- wait_for_child_process_to_exit-source -->
            
          </div>

          

          
        </div><!-- wait_for_child_process_to_exit-method -->

      
        <div id="win_platform-3F-method" class="method-detail ">
          <a name="method-i-win_platform-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">win_platform?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Is this test being run on a Windows platform?</p>
            

            
            <div class="method-source-code" id="win_platform-3F-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 822</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">win_platform?</span>
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">win_platform?</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- win_platform-3F-source -->
            
          </div>

          

          
        </div><!-- win_platform-3F-method -->

      
        <div id="write_file-method" class="method-detail ">
          <a name="method-i-write_file"></a>

          
          <div class="method-heading">
            <span class="method-name">write_file</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Writes a binary file to <tt>path</tt> which is relative to +@gemhome+</p>
            

            
            <div class="method-source-code" id="write_file-source">
<pre>
<span class="ruby-comment"># File lib/rubygems/test_case.rb, line 357</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">write_file</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-ivar">@gemhome</span>, <span class="ruby-identifier">path</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">absolute?</span>
  <span class="ruby-identifier">dir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span> <span class="ruby-identifier">path</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-identifier">dir</span>

  <span class="ruby-identifier">open</span> <span class="ruby-identifier">path</span>, <span class="ruby-string">'wb'</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">io</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">path</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- write_file-source -->
            
          </div>

          

          
        </div><!-- write_file-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

