<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Module: Minitest::Spec::DSL</title>

  <link rel="stylesheet" href="../../rdoc.css" type="text/css" media="screen" />

  <script src="../../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="module">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../../index.html">Home</a>
          <a href="../../index.html#classes">Classes</a>
          <a href="../../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../../lib/minitest/spec_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/minitest/spec.rb">lib/minitest/spec.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-i-after">#after</a></li>
          
          <li><a href="#method-i-before">#before</a></li>
          
          <li><a href="#method-i-children">#children</a></li>
          
          <li><a href="#method-i-it">#it</a></li>
          
          <li><a href="#method-i-let">#let</a></li>
          
          <li><a href="#method-i-register_spec_type">#register_spec_type</a></li>
          
          <li><a href="#method-i-spec_type">#spec_type</a></li>
          
          <li><a href="#method-i-subject">#subject</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="../../History_txt.html">History.txt</a></li>
        
          <li class="file"><a href="../../Manifest_txt.html">Manifest.txt</a></li>
        
          <li class="file"><a href="../../README_txt.html">README.txt</a></li>
        
          <li class="file"><a href="../../Rakefile.html">Rakefile</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../../Minitest.html">Minitest</a></li>
        
          <li><a href="../../Minitest/Assertion.html">Minitest::Assertion</a></li>
        
          <li><a href="../../Minitest/Assertions.html">Minitest::Assertions</a></li>
        
          <li><a href="../../Minitest/BacktraceFilter.html">Minitest::BacktraceFilter</a></li>
        
          <li><a href="../../Minitest/BenchSpec.html">Minitest::BenchSpec</a></li>
        
          <li><a href="../../Minitest/Benchmark.html">Minitest::Benchmark</a></li>
        
          <li><a href="../../Minitest/CompositeReporter.html">Minitest::CompositeReporter</a></li>
        
          <li><a href="../../Minitest/Expectations.html">Minitest::Expectations</a></li>
        
          <li><a href="../../Minitest/Guard.html">Minitest::Guard</a></li>
        
          <li><a href="../../Minitest/Mock.html">Minitest::Mock</a></li>
        
          <li><a href="../../Minitest/ParallelEach.html">Minitest::ParallelEach</a></li>
        
          <li><a href="../../Minitest/PrideIO.html">Minitest::PrideIO</a></li>
        
          <li><a href="../../Minitest/PrideLOL.html">Minitest::PrideLOL</a></li>
        
          <li><a href="../../Minitest/Reporter.html">Minitest::Reporter</a></li>
        
          <li><a href="../../Minitest/Runnable.html">Minitest::Runnable</a></li>
        
          <li><a href="../../Minitest/Skip.html">Minitest::Skip</a></li>
        
          <li><a href="../../Minitest/Spec.html">Minitest::Spec</a></li>
        
          <li><a href="../../Minitest/Spec/DSL.html">Minitest::Spec::DSL</a></li>
        
          <li><a href="../../Minitest/Test.html">Minitest::Test</a></li>
        
          <li><a href="../../Minitest/Test/LifecycleHooks.html">Minitest::Test::LifecycleHooks</a></li>
        
          <li><a href="../../Minitest/UnexpectedError.html">Minitest::UnexpectedError</a></li>
        
          <li><a href="../../TestMinitestRunner.html">TestMinitestRunner</a></li>
        
          <li><a href="../../TestMinitestRunner/Latch.html">TestMinitestRunner::Latch</a></li>
        
          <li><a href="../../AnError.html">AnError</a></li>
        
          <li><a href="../../ExampleA.html">ExampleA</a></li>
        
          <li><a href="../../ExampleB.html">ExampleB</a></li>
        
          <li><a href="../../ImmutableString.html">ImmutableString</a></li>
        
          <li><a href="../../Kernel.html">Kernel</a></li>
        
          <li><a href="../../MetaMetaMetaTestCase.html">MetaMetaMetaTestCase</a></li>
        
          <li><a href="../../MiniSpecA.html">MiniSpecA</a></li>
        
          <li><a href="../../MiniSpecB.html">MiniSpecB</a></li>
        
          <li><a href="../../MiniSpecC.html">MiniSpecC</a></li>
        
          <li><a href="../../MockExpectationError.html">MockExpectationError</a></li>
        
          <li><a href="../../Module.html">Module</a></li>
        
          <li><a href="../../MyModule.html">MyModule</a></li>
        
          <li><a href="../../NamedExampleA.html">NamedExampleA</a></li>
        
          <li><a href="../../NamedExampleB.html">NamedExampleB</a></li>
        
          <li><a href="../../NamedExampleC.html">NamedExampleC</a></li>
        
          <li><a href="../../Object.html">Object</a></li>
        
          <li><a href="../../SubThingySpec.html">SubThingySpec</a></li>
        
          <li><a href="../../TestMeta.html">TestMeta</a></li>
        
          <li><a href="../../TestMetaStatic.html">TestMetaStatic</a></li>
        
          <li><a href="../../TestMinitestBenchmark.html">TestMinitestBenchmark</a></li>
        
          <li><a href="../../TestMinitestGuard.html">TestMinitestGuard</a></li>
        
          <li><a href="../../TestMinitestMock.html">TestMinitestMock</a></li>
        
          <li><a href="../../TestMinitestReporter.html">TestMinitestReporter</a></li>
        
          <li><a href="../../TestMinitestRunnable.html">TestMinitestRunnable</a></li>
        
          <li><a href="../../TestMinitestStub.html">TestMinitestStub</a></li>
        
          <li><a href="../../TestMinitestTest.html">TestMinitestTest</a></li>
        
          <li><a href="../../TestMinitestUnit.html">TestMinitestUnit</a></li>
        
          <li><a href="../../TestMinitestUnitInherited.html">TestMinitestUnitInherited</a></li>
        
          <li><a href="../../TestMinitestUnitOrder.html">TestMinitestUnitOrder</a></li>
        
          <li><a href="../../TestMinitestUnitRecording.html">TestMinitestUnitRecording</a></li>
        
          <li><a href="../../TestMinitestUnitTestCase.html">TestMinitestUnitTestCase</a></li>
        
          <li><a href="../../TestSpecInTestCase.html">TestSpecInTestCase</a></li>
        
          <li><a href="../../ThingySpec.html">ThingySpec</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="module">Minitest::Spec::DSL</h1>

    <div id="description" class="description">
      
<p>Oh look! A <a href="DSL.html">Minitest::Spec::DSL</a> module! Eat your
heart out DHH.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      
      <!-- Constants -->
      <div id="constants-list" class="section">
        <h3 class="section-header">Constants</h3>
        <dl>
        
          <dt><a name="TYPES">TYPES</a></dt>
          
          <dd class="description"><p>Contains pairs of matchers and <a href="../Spec.html">Spec</a> classes to
be used to calculate the superclass of a top-level describe. This allows
for automatically customizable spec types.</p>

<p>See: <a href="DSL.html#method-i-register_spec_type">register_spec_type</a>
and <a href="DSL.html#method-i-spec_type">spec_type</a></p></dd>
          
        
        </dl>
      </div>
      

      

      <!-- Methods -->
      
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="after-method" class="method-detail ">
          <a name="method-i-after"></a>

          
          <div class="method-heading">
            <span class="method-name">after</span><span
              class="method-args">(type = nil, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Define an ‘after’ action. Inherits the way normal methods should.</p>

<p>NOTE: <tt>type</tt> is ignored and is only there to make porting easier.</p>

<p>Equivalent to <a
href="../Test/LifecycleHooks.html#method-i-teardown">Minitest::Test#teardown</a>.</p>
            

            
            <div class="method-source-code" id="after-source">
<pre>
<span class="ruby-comment"># File lib/minitest/spec.rb, line 185</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">after</span> <span class="ruby-identifier">type</span> = <span class="ruby-keyword">nil</span>, &amp;<span class="ruby-identifier">block</span>
  <span class="ruby-identifier">define_method</span> <span class="ruby-value">:teardown</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">instance_eval</span>(&amp;<span class="ruby-identifier">block</span>)
    <span class="ruby-keyword">super</span>()
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- after-source -->
            
          </div>

          

          
        </div><!-- after-method -->

      
        <div id="before-method" class="method-detail ">
          <a name="method-i-before"></a>

          
          <div class="method-heading">
            <span class="method-name">before</span><span
              class="method-args">(type = nil, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Define a ‘before’ action. Inherits the way normal methods should.</p>

<p>NOTE: <tt>type</tt> is ignored and is only there to make porting easier.</p>

<p>Equivalent to <a
href="../Test/LifecycleHooks.html#method-i-setup">Minitest::Test#setup</a>.</p>
            

            
            <div class="method-source-code" id="before-source">
<pre>
<span class="ruby-comment"># File lib/minitest/spec.rb, line 171</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">before</span> <span class="ruby-identifier">type</span> = <span class="ruby-keyword">nil</span>, &amp;<span class="ruby-identifier">block</span>
  <span class="ruby-identifier">define_method</span> <span class="ruby-value">:setup</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">super</span>()
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">instance_eval</span>(&amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- before-source -->
            
          </div>

          

          
        </div><!-- before-method -->

      
        <div id="children-method" class="method-detail ">
          <a name="method-i-children"></a>

          
          <div class="method-heading">
            <span class="method-name">children</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the children of this spec.</p>
            

            
            <div class="method-source-code" id="children-source">
<pre>
<span class="ruby-comment"># File lib/minitest/spec.rb, line 154</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">children</span>
  <span class="ruby-ivar">@children</span> <span class="ruby-operator">||=</span> []
<span class="ruby-keyword">end</span></pre>
            </div><!-- children-source -->
            
          </div>

          

          
        </div><!-- children-method -->

      
        <div id="it-method" class="method-detail ">
          <a name="method-i-it"></a>

          
          <div class="method-heading">
            <span class="method-name">it</span><span
              class="method-args">(desc = "anonymous", &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Define an expectation with name <tt>desc</tt>. Name gets morphed to a
proper test method name. For some freakish reason, people who write specs
don’t like class inheritance, so this goes way out of its way to make sure
that expectations aren’t inherited.</p>

<p>This is also aliased to specify and doesn’t require a <tt>desc</tt> arg.</p>

<p>Hint: If you <em>do</em> want inheritence, use minitest/unit. You can mix
and match between assertions and expectations as much as you want.</p>
            

            
            <div class="method-source-code" id="it-source">
<pre>
<span class="ruby-comment"># File lib/minitest/spec.rb, line 203</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">it</span> <span class="ruby-identifier">desc</span> = <span class="ruby-string">&quot;anonymous&quot;</span>, &amp;<span class="ruby-identifier">block</span>
  <span class="ruby-identifier">block</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">proc</span> { <span class="ruby-identifier">skip</span> <span class="ruby-string">&quot;(no tests defined)&quot;</span> }

  <span class="ruby-ivar">@specs</span> <span class="ruby-operator">||=</span> <span class="ruby-value">0</span>
  <span class="ruby-ivar">@specs</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>

  <span class="ruby-identifier">name</span> = <span class="ruby-string">&quot;test_%04d_%s&quot;</span> <span class="ruby-operator">%</span> [ <span class="ruby-ivar">@specs</span>, <span class="ruby-identifier">desc</span> ]

  <span class="ruby-identifier">define_method</span> <span class="ruby-identifier">name</span>, &amp;<span class="ruby-identifier">block</span>

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">children</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">mod</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">send</span> <span class="ruby-value">:undef_method</span>, <span class="ruby-identifier">name</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">public_method_defined?</span> <span class="ruby-identifier">name</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">name</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- it-source -->
            
          </div>

          

          
        </div><!-- it-method -->

      
        <div id="let-method" class="method-detail ">
          <a name="method-i-let"></a>

          
          <div class="method-heading">
            <span class="method-name">let</span><span
              class="method-args">(name, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Essentially, define an accessor for <tt>name</tt> with <tt>block</tt>.</p>

<p>Why use let instead of def? I honestly don’t know.</p>
            

            
            <div class="method-source-code" id="let-source">
<pre>
<span class="ruby-comment"># File lib/minitest/spec.rb, line 225</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">let</span> <span class="ruby-identifier">name</span>, &amp;<span class="ruby-identifier">block</span>
  <span class="ruby-identifier">define_method</span> <span class="ruby-identifier">name</span> <span class="ruby-keyword">do</span>
    <span class="ruby-ivar">@_memoized</span> <span class="ruby-operator">||=</span> {}
    <span class="ruby-ivar">@_memoized</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-identifier">name</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@_memoized</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">instance_eval</span>(&amp;<span class="ruby-identifier">block</span>) }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- let-source -->
            
          </div>

          

          
        </div><!-- let-method -->

      
        <div id="register_spec_type-method" class="method-detail ">
          <a name="method-i-register_spec_type"></a>

          
          <div class="method-heading">
            <span class="method-name">register_spec_type</span><span
              class="method-args">(*args, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Register a new type of spec that matches the spec’s description. This
method can take either a Regexp and a spec class or a spec class and a
block that takes the description and returns true if it matches.</p>

<p>Eg:</p>

<pre>register_spec_type(/Controller$/, Minitest::Spec::Rails)</pre>

<p>or:</p>

<pre>register_spec_type(Minitest::Spec::RailsModel) do |desc|
  desc.superclass == ActiveRecord::Base
end</pre>
            

            
            <div class="method-source-code" id="register_spec_type-source">
<pre>
<span class="ruby-comment"># File lib/minitest/spec.rb, line 122</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">register_spec_type</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">matcher</span>, <span class="ruby-identifier">klass</span> = <span class="ruby-identifier">block</span>, <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">matcher</span>, <span class="ruby-identifier">klass</span> = *<span class="ruby-identifier">args</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">TYPES</span>.<span class="ruby-identifier">unshift</span> [<span class="ruby-identifier">matcher</span>, <span class="ruby-identifier">klass</span>]
<span class="ruby-keyword">end</span></pre>
            </div><!-- register_spec_type-source -->
            
          </div>

          

          
        </div><!-- register_spec_type-method -->

      
        <div id="spec_type-method" class="method-detail ">
          <a name="method-i-spec_type"></a>

          
          <div class="method-heading">
            <span class="method-name">spec_type</span><span
              class="method-args">(desc)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Figure out the spec class to use based on a spec’s description. Eg:</p>

<pre>spec_type(&quot;BlahController&quot;) # =&gt; Minitest::Spec::Rails</pre>
            

            
            <div class="method-source-code" id="spec_type-source">
<pre>
<span class="ruby-comment"># File lib/minitest/spec.rb, line 136</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">spec_type</span> <span class="ruby-identifier">desc</span>
  <span class="ruby-constant">TYPES</span>.<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">matcher</span>, <span class="ruby-identifier">klass</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">matcher</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:call</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">matcher</span>.<span class="ruby-identifier">call</span> <span class="ruby-identifier">desc</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">matcher</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">desc</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-keyword">end</span>
  }.<span class="ruby-identifier">last</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- spec_type-source -->
            
          </div>

          

          
        </div><!-- spec_type-method -->

      
        <div id="subject-method" class="method-detail ">
          <a name="method-i-subject"></a>

          
          <div class="method-heading">
            <span class="method-name">subject</span><span
              class="method-args">(&block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Another lazy man’s accessor generator. Made even more lazy by setting the
name for you to <tt>subject</tt>.</p>
            

            
            <div class="method-source-code" id="subject-source">
<pre>
<span class="ruby-comment"># File lib/minitest/spec.rb, line 236</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">subject</span> &amp;<span class="ruby-identifier">block</span>
  <span class="ruby-identifier">let</span> <span class="ruby-value">:subject</span>, &amp;<span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- subject-source -->
            
          </div>

          

          
        </div><!-- subject-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

